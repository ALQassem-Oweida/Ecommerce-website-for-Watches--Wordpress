jQuery(document).ready((function(e){let r=woocommerce_photo_reviews_params.hasOwnProperty("comments_container_id")?woocommerce_photo_reviews_params.comments_container_id:"comments";e("#"+r).prepend(e(".wcpr-filter-container")).prepend(e(".wcpr-overall-rating-and-rating-count")).prepend(e(".woocommerce-Reviews-title").eq(0));let a=woocommerce_photo_reviews_params.max_files;function o(e,r,a=""){let o,t=`<img title="${r}" src="${e}" class="wcpr-selected-image-preview">`;return o=a?`<div class="wcpr-selected-image">${t}<div class="wcpr-selected-image-info"><div class="wcpr-selected-image-name wcpr-comment-form-error" >${a}</div></div></div>`:`<div class="wcpr-selected-image">${t}<div class="wcpr-selected-image-info"><div class="wcpr-selected-image-name" title="${r}">${r}</div></div></div>`,o}e("#commentform").on("change",".wcpr_image_upload",(function(r){if(e(this).parent().find(".wcpr-selected-image-container").html(""),this.files.length>a)return alert(woocommerce_photo_reviews_params.warning_max_files),e(this).val(""),!1;this.files.length>0&&function(r){let a=1024*parseFloat(woocommerce_photo_reviews_params.max_file_size);for(let i=0;i<r.files.length;i++){var t=new FileReader;t.onload=function(t){let n="";-1===woocommerce_photo_reviews_params.upload_allow.indexOf(r.files[i].type)?n=woocommerce_photo_reviews_params.warning_upload_allow.replace("%file_name%",r.files[i].name):r.files[i].size>a&&(n=woocommerce_photo_reviews_params.warning_max_file_size.replace("%file_name%",r.files[i].name)),e(r).parent().find(".wcpr-selected-image-container").append(o(t.target.result,r.files[i].name,n))},t.readAsDataURL(r.files[i])}}(this)})),e("#commentform").find('input[type="submit"]').on("click",(function(r){let o=e(this).closest("form"),t=o.find('textarea[id="comment"]')||o.find('textarea[name="comment"]'),i=o.find('input[name="author"]'),n=o.find('input[name="email"]');if(t.length>0&&!t.val())return alert(woocommerce_photo_reviews_params.i18n_required_comment_text),r.preventDefault(),t.focus(),!1;if("on"===woocommerce_photo_reviews_params.enable_photo){o.attr("enctype")&&"multipart/form-data"===o.attr("enctype")||o.attr("enctype","multipart/form-data");let e=o.find(".wcpr_image_upload");if(e.length>0){let o=e.get(0).files,t=parseInt(o.length);if("on"===woocommerce_photo_reviews_params.required_image&&0===t)return alert(woocommerce_photo_reviews_params.warning_required_image),r.preventDefault(),!1;if(t>a)return alert(woocommerce_photo_reviews_params.warning_max_files),r.preventDefault(),!1;let i=[],n=1024*parseFloat(woocommerce_photo_reviews_params.max_file_size);if(jQuery.each(o,(function(e,r){if(-1===woocommerce_photo_reviews_params.upload_allow.indexOf(r.type))return i.push(woocommerce_photo_reviews_params.warning_upload_allow.replace("%file_name%",r.name)),!0;r.size>n&&i.push(woocommerce_photo_reviews_params.warning_max_file_size.replace("%file_name%",r.name))})),i.length)return alert(i.join("\n")),r.preventDefault(),!1}else if("on"===woocommerce_photo_reviews_params.required_image)return alert(woocommerce_photo_reviews_params.warning_required_image),r.preventDefault(),!1}return i.length>0&&i.attr("required")&&!i.val()?(alert(woocommerce_photo_reviews_params.i18n_required_name_text),r.preventDefault(),i.focus(),!1):n.length>0&&n.attr("required")&&!n.val()?(alert(woocommerce_photo_reviews_params.i18n_required_email_text),r.preventDefault(),n.focus(),!1):!1===o.find('input[name="wcpr_gdpr_checkbox"]').prop("checked")?(alert(woocommerce_photo_reviews_params.warning_gdpr),r.preventDefault(),!1):void 0}))}));