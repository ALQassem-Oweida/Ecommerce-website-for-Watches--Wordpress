"use strict";(self.webpackChunkMailPoet3=self.webpackChunkMailPoet3||[]).push([[392],{29488:function(e,t,n){var r={};n.r(r),n.d(r,{setIsMatching:function(){return B}});var i={};n.r(i),n.d(i,{isViewportMatch:function(){return L}});var o={};n.r(o),n.d(o,{set:function(){return H},setDefaults:function(){return $},setPersistenceLayer:function(){return G},toggle:function(){return W}});var s={};n.r(s),n.d(s,{get:function(){return z}});var a={};n.r(a),n.d(a,{disableComplementaryArea:function(){return J},enableComplementaryArea:function(){return q},pinItem:function(){return Q},setDefaultComplementaryArea:function(){return Y},setFeatureDefaults:function(){return ne},setFeatureValue:function(){return te},toggleFeature:function(){return ee},unpinItem:function(){return X}});var l={};n.r(l),n.d(l,{getActiveComplementaryArea:function(){return ie},isFeatureActive:function(){return se},isItemPinned:function(){return oe}});var c={};n.r(c),n.d(c,{activate:function(){return nt},closeSidebar:function(){return Ye},openSidebar:function(){return Ke},registerStepType:function(){return rt},save:function(){return tt},selectStep:function(){return Xe},setInserterPopoverAnchor:function(){return Qe},setWorkflowName:function(){return et},toggleFeature:function(){return qe},toggleInserterSidebar:function(){return Je},updateStepArgs:function(){return it}});var u={};n.r(u),n.d(u,{getInserterActionSteps:function(){return ct},getInserterLogicalSteps:function(){return ut},getInserterPopoverAnchor:function(){return dt},getSelectedStep:function(){return ft},getSelectedStepType:function(){return ht},getStepType:function(){return gt},getWorkflowData:function(){return pt},getWorkflowSaved:function(){return mt},isFeatureActive:function(){return st},isInserterSidebarOpened:function(){return lt},isSidebarOpened:function(){return at}});var d={};n.r(d),n.d(d,{__experimentalGetDefaultTemplatePartAreas:function(){return Vi},__experimentalGetDefaultTemplateType:function(){return Wi},__experimentalGetDefaultTemplateTypes:function(){return Ui},__experimentalGetTemplateInfo:function(){return Hi},__unstableIsEditorReady:function(){return Or},canInsertBlockType:function(){return Mi},canUserUseUnfilteredHTML:function(){return Zr},didPostSaveRequestFail:function(){return hr},didPostSaveRequestSucceed:function(){return gr},getActivePostLock:function(){return Ir},getAdjacentBlockClientId:function(){return li},getAutosaveAttribute:function(){return nr},getBlock:function(){return zr},getBlockAttributes:function(){return Gr},getBlockCount:function(){return Xr},getBlockHierarchyRootClientId:function(){return ai},getBlockIndex:function(){return Si},getBlockInsertionPoint:function(){return Ii},getBlockListSettings:function(){return Fi},getBlockMode:function(){return Ci},getBlockName:function(){return Hr},getBlockOrder:function(){return ki},getBlockRootClientId:function(){return si},getBlockSelectionEnd:function(){return ti},getBlockSelectionStart:function(){return ei},getBlocks:function(){return Kr},getBlocksByClientId:function(){return Qr},getClientIdsOfDescendants:function(){return Yr},getClientIdsWithDescendants:function(){return qr},getCurrentPost:function(){return Kn},getCurrentPostAttribute:function(){return er},getCurrentPostId:function(){return qn},getCurrentPostLastRevisionId:function(){return Qn},getCurrentPostRevisionsCount:function(){return Jn},getCurrentPostType:function(){return Yn},getEditedPostAttribute:function(){return tr},getEditedPostContent:function(){return kr},getEditedPostPreviewLink:function(){return br},getEditedPostSlug:function(){return xr},getEditedPostVisibility:function(){return rr},getEditorBlocks:function(){return Lr},getEditorSelection:function(){return Rr},getEditorSelectionEnd:function(){return Mr},getEditorSelectionStart:function(){return Dr},getEditorSettings:function(){return Fr},getFirstMultiSelectedBlockClientId:function(){return fi},getGlobalBlockCount:function(){return Jr},getInserterItems:function(){return Ri},getLastMultiSelectedBlockClientId:function(){return gi},getMultiSelectedBlockClientIds:function(){return pi},getMultiSelectedBlocks:function(){return mi},getMultiSelectedBlocksEndClientId:function(){return yi},getMultiSelectedBlocksStartClientId:function(){return bi},getNextBlockClientId:function(){return ui},getPermalink:function(){return Er},getPermalinkParts:function(){return Tr},getPostEdits:function(){return Xn},getPostLockUser:function(){return Ar},getPostTypeLabel:function(){return $i},getPreviousBlockClientId:function(){return ci},getSelectedBlock:function(){return oi},getSelectedBlockClientId:function(){return ii},getSelectedBlockCount:function(){return ni},getSelectedBlocksInitialCaretPosition:function(){return di},getStateBeforeOptimisticTransaction:function(){return Ur},getSuggestedPostFormat:function(){return yr},getTemplate:function(){return Li},getTemplateLock:function(){return Di},hasChangedContent:function(){return Hn},hasEditorRedo:function(){return Vn},hasEditorUndo:function(){return Un},hasInserterItems:function(){return Oi},hasMultiSelection:function(){return Ti},hasNonPostEntityChanges:function(){return Gn},hasSelectedBlock:function(){return ri},hasSelectedInnerBlock:function(){return Ei},inSomeHistory:function(){return Vr},isAncestorMultiSelected:function(){return _i},isAutosavingPost:function(){return vr},isBlockInsertionPointVisible:function(){return Zi},isBlockMultiSelected:function(){return vi},isBlockSelected:function(){return wi},isBlockValid:function(){return $r},isBlockWithinSelection:function(){return xi},isCaretWithinFormattedText:function(){return Ai},isCleanNewPost:function(){return zn},isCurrentPostPending:function(){return ir},isCurrentPostPublished:function(){return or},isCurrentPostScheduled:function(){return sr},isEditedPostAutosaveable:function(){return ur},isEditedPostBeingScheduled:function(){return dr},isEditedPostDateFloating:function(){return pr},isEditedPostDirty:function(){return $n},isEditedPostEmpty:function(){return cr},isEditedPostNew:function(){return Wn},isEditedPostPublishable:function(){return ar},isEditedPostSaveable:function(){return lr},isFirstMultiSelectedBlock:function(){return hi},isMultiSelecting:function(){return Pi},isPermalinkEditable:function(){return wr},isPostAutosavingLocked:function(){return Cr},isPostLockTakeover:function(){return Nr},isPostLocked:function(){return Pr},isPostSavingLocked:function(){return jr},isPreviewingPost:function(){return _r},isPublishSidebarEnabled:function(){return Br},isPublishingPost:function(){return Sr},isSavingNonPostEntityChanges:function(){return fr},isSavingPost:function(){return mr},isSelectionEnabled:function(){return ji},isTyping:function(){return Ni},isValidTemplate:function(){return Bi}});var p={};n.r(p),n.d(p,{__experimentalTearDownEditor:function(){return qi},autosave:function(){return io},clearSelectedBlock:function(){return Po},createUndoLevel:function(){return ao},disablePublishSidebar:function(){return uo},editPost:function(){return eo},enablePublishSidebar:function(){return co},enterFormattedText:function(){return Go},exitFormattedText:function(){return zo},hideInsertionPoint:function(){return Mo},insertBlock:function(){return Bo},insertBlocks:function(){return Lo},insertDefaultBlock:function(){return Ko},lockPostAutosaving:function(){return fo},lockPostSaving:function(){return po},mergeBlocks:function(){return Fo},moveBlockToPosition:function(){return Zo},moveBlocksDown:function(){return Ao},moveBlocksUp:function(){return Io},multiSelect:function(){return To},receiveBlocks:function(){return yo},redo:function(){return oo},refreshPost:function(){return no},removeBlock:function(){return Vo},removeBlocks:function(){return Uo},replaceBlock:function(){return No},replaceBlocks:function(){return Co},resetBlocks:function(){return bo},resetEditorBlocks:function(){return ho},resetPost:function(){return Ji},savePost:function(){return to},selectBlock:function(){return wo},setTemplateValidity:function(){return Ro},setupEditor:function(){return Yi},setupEditorState:function(){return Xi},showInsertionPoint:function(){return Do},startMultiSelect:function(){return Eo},startTyping:function(){return Ho},stopMultiSelect:function(){return xo},stopTyping:function(){return $o},synchronizeTemplate:function(){return Oo},toggleBlockMode:function(){return Wo},toggleSelection:function(){return jo},trashPost:function(){return ro},undo:function(){return so},unlockPostAutosaving:function(){return go},unlockPostSaving:function(){return mo},updateBlock:function(){return ko},updateBlockAttributes:function(){return So},updateBlockListSettings:function(){return Yo},updateEditorSettings:function(){return vo},updatePost:function(){return Qi},updatePostLock:function(){return lo}});var m=n(65443),f=n.n(m),g=n(64151),h=n(33851),v=n(52278),_=n(3610),b=n(90057),y=n(87834),k=n(49231),S=n(33140),w=(0,k.createElement)(S.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,k.createElement)(S.y$,{d:"M20 10c0-5.51-4.49-10-10-10C4.48 0 0 4.49 0 10c0 5.52 4.48 10 10 10 5.51 0 10-4.48 10-10zM7.78 15.37L4.37 6.22c.55-.02 1.17-.08 1.17-.08.5-.06.44-1.13-.06-1.11 0 0-1.45.11-2.37.11-.18 0-.37 0-.58-.01C4.12 2.69 6.87 1.11 10 1.11c2.33 0 4.45.87 6.05 2.34-.68-.11-1.65.39-1.65 1.58 0 .74.45 1.36.9 2.1.35.61.55 1.36.55 2.46 0 1.49-1.4 5-1.4 5l-3.03-8.37c.54-.02.82-.17.82-.17.5-.05.44-1.25-.06-1.22 0 0-1.44.12-2.38.12-.87 0-2.33-.12-2.33-.12-.5-.03-.56 1.2-.06 1.22l.92.08 1.26 3.41zM17.41 10c.24-.64.74-1.87.43-4.25.7 1.29 1.05 2.71 1.05 4.25 0 3.29-1.73 6.24-4.4 7.78.97-2.59 1.94-5.2 2.92-7.78zM6.1 18.09C3.12 16.65 1.11 13.53 1.11 10c0-1.3.23-2.48.72-3.59C3.25 10.3 4.67 14.2 6.1 18.09zm4.03-6.63l2.58 6.98c-.86.29-1.76.45-2.71.45-.79 0-1.57-.11-2.29-.33.81-2.38 1.62-4.74 2.42-7.1z"})),E=n(86215),x=n(76874),T=n(85479),P=n(30337),j=n(62271),C=(0,k.createElement)(S.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,k.createElement)(S.y$,{d:"M11.776 4.454a.25.25 0 01.448 0l2.069 4.192a.25.25 0 00.188.137l4.626.672a.25.25 0 01.139.426l-3.348 3.263a.25.25 0 00-.072.222l.79 4.607a.25.25 0 01-.362.263l-4.138-2.175a.25.25 0 00-.232 0l-4.138 2.175a.25.25 0 01-.363-.263l.79-4.607a.25.25 0 00-.071-.222L4.754 9.881a.25.25 0 01.139-.426l4.626-.672a.25.25 0 00.188-.137l2.069-4.192z"})),N=(0,k.createElement)(S.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,k.createElement)(S.y$,{fillRule:"evenodd",d:"M9.706 8.646a.25.25 0 01-.188.137l-4.626.672a.25.25 0 00-.139.427l3.348 3.262a.25.25 0 01.072.222l-.79 4.607a.25.25 0 00.362.264l4.138-2.176a.25.25 0 01.233 0l4.137 2.175a.25.25 0 00.363-.263l-.79-4.607a.25.25 0 01.072-.222l3.347-3.262a.25.25 0 00-.139-.427l-4.626-.672a.25.25 0 01-.188-.137l-2.069-4.192a.25.25 0 00-.448 0L9.706 8.646zM12 7.39l-.948 1.921a1.75 1.75 0 01-1.317.957l-2.12.308 1.534 1.495c.412.402.6.982.503 1.55l-.362 2.11 1.896-.997a1.75 1.75 0 011.629 0l1.895.997-.362-2.11a1.75 1.75 0 01.504-1.55l1.533-1.495-2.12-.308a1.75 1.75 0 01-1.317-.957L12 7.39z",clipRule:"evenodd"})),A=n(61888),I=n(38104),Z=n(18024);function B(e){return{type:"SET_IS_MATCHING",values:e}}function L(e,t){return-1===t.indexOf(" ")&&(t=">= "+t),!!e[t]}const D=(0,Z.Z)("core/viewport",{reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return"SET_IS_MATCHING"===t.type?t.values:e},actions:r,selectors:i});(0,I.register)(D);((e,t)=>{const n=(0,A.debounce)((()=>{const e=(0,A.mapValues)(r,(e=>e.matches));(0,I.dispatch)(D).setIsMatching(e)}),{leading:!0}),r=(0,A.reduce)(e,((e,r,i)=>((0,A.forEach)(t,((t,o)=>{const s=window.matchMedia(`(${t}: ${r}px)`);s.addListener(n);const a=[o,i].join(" ");e[a]=s})),e)),{});window.addEventListener("orientationchange",n),n(),n.flush()})({huge:1440,wide:1280,large:960,medium:782,small:600,mobile:480},{"<":"max-width",">=":"min-width"});var M=n(62355),R=n(41356),O=n(79097),F=n.n(O);const U=function(e){let t;return(e,n)=>{if("SET_PERSISTENCE_LAYER"===n.type){const{persistenceLayer:e,persistedData:r}=n;return t=e,r}const r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if("SET_PREFERENCE_VALUE"===t.type){const{scope:n,name:r,value:i}=t;return{...e,[n]:{...e[n],[r]:i}}}return e}(e,n);var i;return"SET_PREFERENCE_VALUE"===n.type&&(null===(i=t)||void 0===i||i.set(r)),r}}();var V=F()({defaults:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if("SET_PREFERENCE_DEFAULTS"===t.type){const{scope:n,defaults:r}=t;return{...e,[n]:{...e[n],...r}}}return e},preferences:U});function W(e,t){return function(n){let{select:r,dispatch:i}=n;const o=r.get(e,t);i.set(e,t,!o)}}function H(e,t,n){return{type:"SET_PREFERENCE_VALUE",scope:e,name:t,value:n}}function $(e,t){return{type:"SET_PREFERENCE_DEFAULTS",scope:e,defaults:t}}async function G(e){const t=await e.get();return{type:"SET_PERSISTENCE_LAYER",persistenceLayer:e,persistedData:t}}function z(e,t,n){var r,i;const o=null===(r=e.preferences[t])||void 0===r?void 0:r[n];return void 0!==o?o:null===(i=e.defaults[t])||void 0===i?void 0:i[n]}const K=(0,Z.Z)("core/preferences",{reducer:V,actions:o,selectors:s});(0,I.register)(K);const Y=(e,t)=>({type:"SET_DEFAULT_COMPLEMENTARY_AREA",scope:e,area:t}),q=(e,t)=>n=>{let{registry:r,dispatch:i}=n;t&&(r.select(K).get(e,"isComplementaryAreaVisible")||r.dispatch(K).set(e,"isComplementaryAreaVisible",!0),i({type:"ENABLE_COMPLEMENTARY_AREA",scope:e,area:t}))},J=e=>t=>{let{registry:n}=t;n.select(K).get(e,"isComplementaryAreaVisible")&&n.dispatch(K).set(e,"isComplementaryAreaVisible",!1)},Q=(e,t)=>n=>{let{registry:r}=n;if(!t)return;const i=r.select(K).get(e,"pinnedItems");!0!==(null==i?void 0:i[t])&&r.dispatch(K).set(e,"pinnedItems",{...i,[t]:!0})},X=(e,t)=>n=>{let{registry:r}=n;if(!t)return;const i=r.select(K).get(e,"pinnedItems");r.dispatch(K).set(e,"pinnedItems",{...i,[t]:!1})};function ee(e,t){return function(n){let{registry:r}=n;(0,R.Z)("dispatch( 'core/interface' ).toggleFeature",{since:"6.0",alternative:"dispatch( 'core/preferences' ).toggle"}),r.dispatch(K).toggle(e,t)}}function te(e,t,n){return function(r){let{registry:i}=r;(0,R.Z)("dispatch( 'core/interface' ).setFeatureValue",{since:"6.0",alternative:"dispatch( 'core/preferences' ).set"}),i.dispatch(K).set(e,t,!!n)}}function ne(e,t){return function(n){let{registry:r}=n;(0,R.Z)("dispatch( 'core/interface' ).setFeatureDefaults",{since:"6.0",alternative:"dispatch( 'core/preferences' ).setDefaults"}),r.dispatch(K).setDefaults(e,t)}}var re=n(96982);const ie=(0,re.M)((e=>(t,n)=>{var r;const i=e(K).get(n,"isComplementaryAreaVisible");if(void 0!==i)return i?null==t||null===(r=t.complementaryAreas)||void 0===r?void 0:r[n]:null})),oe=(0,re.M)((e=>(t,n,r)=>{var i;const o=e(K).get(n,"pinnedItems");return null===(i=null==o?void 0:o[r])||void 0===i||i})),se=(0,re.M)((e=>(t,n,r)=>((0,R.Z)("select( 'core/interface' ).isFeatureActive( scope, featureName )",{since:"6.0",alternative:"select( 'core/preferences' ).get( scope, featureName )"}),!!e(K).get(n,r))));var ae=F()({complementaryAreas:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DEFAULT_COMPLEMENTARY_AREA":{const{scope:n,area:r}=t;return e[n]?e:{...e,[n]:r}}case"ENABLE_COMPLEMENTARY_AREA":{const{scope:n,area:r}=t;return{...e,[n]:r}}}return e}});const le=(0,Z.Z)("core/interface",{reducer:ae,actions:a,selectors:l});(0,I.register)(le),n(35721);var ce=n(4857),ue=n(73703);const{Consumer:de,Provider:pe}=(0,k.createContext)({name:null,icon:null});var me,fe=(me=(e,t)=>({icon:t.icon||e.icon,identifier:t.identifier||`${e.name}/${t.name}`}),(0,ue.o)((e=>t=>(0,k.createElement)(de,null,(n=>(0,k.createElement)(e,(0,E.Z)({},t,me(n,t)))))),"withPluginContext")),ge=fe((function(e){let{as:t=v.Z,scope:n,identifier:r,icon:i,selectedIcon:o,name:s,...a}=e;const l=t,c=(0,y.Z)((e=>e(le).getActiveComplementaryArea(n)===r),[r]),{enableComplementaryArea:u,disableComplementaryArea:d}=(0,T.Z)(le);return(0,k.createElement)(l,(0,E.Z)({icon:o&&c?o:i,onClick:()=>{c?d(n):u(n,r)}},a))})),he=e=>{let{smallScreenTitle:t,children:n,className:r,toggleButtonProps:i}=e;const o=(0,k.createElement)(ge,(0,E.Z)({icon:M.Z},i));return(0,k.createElement)(k.Fragment,null,(0,k.createElement)("div",{className:"components-panel__header interface-complementary-area-header__small"},t&&(0,k.createElement)("span",{className:"interface-complementary-area-header__small-title"},t),o),(0,k.createElement)("div",{className:f()("components-panel__header","interface-complementary-area-header",r),tabIndex:-1},n,o))},ve=n(73435),_e=n(82741);const be=()=>{};function ye(e){let{name:t,as:n=v.Z,onClick:r,...i}=e;return(0,k.createElement)(h.de,{name:t},(e=>{let{onClick:t}=e;return(0,k.createElement)(n,(0,E.Z)({onClick:r||t?function(){(r||be)(...arguments),(t||be)(...arguments)}:void 0},i))}))}ye.Slot=function(e){let{name:t,as:n=_e.Z,fillProps:r={},bubblesVirtually:i,...o}=e;return(0,k.createElement)(h.g7,{name:t,bubblesVirtually:i,fillProps:r},(e=>{if(!k.Children.toArray(e).length)return null;const t=[];k.Children.forEach(e,(e=>{let{props:{__unstableExplicitMenuItem:n,__unstableTarget:r}}=e;r&&n&&t.push(r)}));const r=k.Children.map(e,(e=>!e.props.__unstableExplicitMenuItem&&t.includes(e.props.__unstableTarget)?null:e));return(0,k.createElement)(n,o,r)}))};var ke=ye;const Se=e=>{let{__unstableExplicitMenuItem:t,__unstableTarget:n,...r}=e;return(0,k.createElement)(ve.Z,r)};function we(e){let{scope:t,target:n,__unstableExplicitMenuItem:r,...i}=e;return(0,k.createElement)(ge,(0,E.Z)({as:e=>(0,k.createElement)(ke,(0,E.Z)({__unstableExplicitMenuItem:r,__unstableTarget:`${t}/${n}`,as:Se,name:`${t}/plugin-more-menu`},e)),role:"menuitemcheckbox",selectedIcon:j.Z,name:n,scope:t},i))}function Ee(e){let{scope:t,...n}=e;return(0,k.createElement)(h.de,(0,E.Z)({name:`PinnedItems/${t}`},n))}Ee.Slot=function(e){let{scope:t,className:n,...r}=e;return(0,k.createElement)(h.g7,(0,E.Z)({name:`PinnedItems/${t}`},r),(e=>(null==e?void 0:e.length)>0&&(0,k.createElement)("div",{className:f()(n,"interface-pinned-items")},e)))};var xe=Ee;function Te(e){let{scope:t,children:n,className:r}=e;return(0,k.createElement)(h.de,{name:`ComplementaryArea/${t}`},(0,k.createElement)("div",{className:r},n))}const Pe=fe((function(e){let{children:t,className:n,closeLabel:r=(0,P.__)("Close plugin"),identifier:i,header:o,headerClassName:s,icon:a,isPinnable:l=!0,panelClassName:c,scope:u,name:d,smallScreenTitle:p,title:m,toggleShortcut:g,isActiveByDefault:h,showIconLabels:_=!1}=e;const{isActive:b,isPinned:S,activeArea:w,isSmall:E,isLarge:A}=(0,y.Z)((e=>{const{getActiveComplementaryArea:t,isItemPinned:n}=e(le),r=t(u);return{isActive:r===i,isPinned:n(u,i),activeArea:r,isSmall:e(D).isViewportMatch("< medium"),isLarge:e(D).isViewportMatch("large")}}),[i,u]);!function(e,t,n,r,i){const o=(0,k.useRef)(!1),s=(0,k.useRef)(!1),{enableComplementaryArea:a,disableComplementaryArea:l}=(0,T.Z)(le);(0,k.useEffect)((()=>{r&&i&&!o.current?(l(e),s.current=!0):s.current&&!i&&o.current?(s.current=!1,a(e,t)):s.current&&n&&n!==t&&(s.current=!1),i!==o.current&&(o.current=i)}),[r,i,e,t,n])}(u,i,w,b,E);const{enableComplementaryArea:I,disableComplementaryArea:Z,pinItem:B,unpinItem:L}=(0,T.Z)(le);return(0,k.useEffect)((()=>{h&&void 0===w&&!E&&I(u,i)}),[w,h,u,i,E]),(0,k.createElement)(k.Fragment,null,l&&(0,k.createElement)(xe,{scope:u},S&&(0,k.createElement)(ge,{scope:u,identifier:i,isPressed:b&&(!_||A),"aria-expanded":b,label:m,icon:_?j.Z:a,showTooltip:!_,variant:_?"tertiary":void 0})),d&&l&&(0,k.createElement)(we,{target:d,scope:u,icon:a},m),b&&(0,k.createElement)(Te,{className:f()("interface-complementary-area",n),scope:u},(0,k.createElement)(he,{className:s,closeLabel:r,onClose:()=>Z(u),smallScreenTitle:p,toggleButtonProps:{label:r,shortcut:g,scope:u,identifier:i}},o||(0,k.createElement)(k.Fragment,null,(0,k.createElement)("strong",null,m),l&&(0,k.createElement)(v.Z,{className:"interface-complementary-area__pin-unpin-item",icon:S?C:N,label:S?(0,P.__)("Unpin from toolbar"):(0,P.__)("Pin to toolbar"),onClick:()=>(S?L:B)(u,i),isPressed:S,"aria-expanded":S}))),(0,k.createElement)(x.Z,{className:c},t)))}));Pe.Slot=function(e){let{scope:t,...n}=e;return(0,k.createElement)(h.g7,(0,E.Z)({name:`ComplementaryArea/${t}`},n))};var je=Pe,Ce=e=>{let{isActive:t}=e;return(0,k.useEffect)((()=>{let e=!1;return document.body.classList.contains("sticky-menu")&&(e=!0,document.body.classList.remove("sticky-menu")),()=>{e&&document.body.classList.add("sticky-menu")}}),[]),(0,k.useEffect)((()=>(t?document.body.classList.add("is-fullscreen-mode"):document.body.classList.remove("is-fullscreen-mode"),()=>{t&&document.body.classList.remove("is-fullscreen-mode")})),[t]),null},Ne=n(28678),Ae=n(10356),Ie=(0,k.forwardRef)((function(e,t){let{footer:n,header:r,sidebar:i,secondarySidebar:o,notices:s,content:a,drawer:l,actions:c,labels:u,className:d,shortcuts:p}=e;const m=(0,Ne.U)(p);!function(e){(0,k.useEffect)((()=>{const t=document&&document.querySelector(`html:not(.${e})`);if(t)return t.classList.toggle(e),()=>{t.classList.toggle(e)}}),[e])}("interface-interface-skeleton__html-container");const g={drawer:(0,P.__)("Drawer"),header:(0,P.__)("Header"),body:(0,P.__)("Content"),secondarySidebar:(0,P.__)("Block Library"),sidebar:(0,P.__)("Settings"),actions:(0,P.__)("Publish"),footer:(0,P.__)("Footer"),...u};return(0,k.createElement)("div",(0,E.Z)({},m,{ref:(0,Ae.Z)([t,m.ref]),className:f()(d,"interface-interface-skeleton",m.className,!!n&&"has-footer")}),!!l&&(0,k.createElement)("div",{className:"interface-interface-skeleton__drawer",role:"region","aria-label":g.drawer,tabIndex:"-1"},l),(0,k.createElement)("div",{className:"interface-interface-skeleton__editor"},!!r&&(0,k.createElement)("div",{className:"interface-interface-skeleton__header",role:"region","aria-label":g.header,tabIndex:"-1"},r),(0,k.createElement)("div",{className:"interface-interface-skeleton__body"},!!o&&(0,k.createElement)("div",{className:"interface-interface-skeleton__secondary-sidebar",role:"region","aria-label":g.secondarySidebar,tabIndex:"-1"},o),!!s&&(0,k.createElement)("div",{className:"interface-interface-skeleton__notices"},s),(0,k.createElement)("div",{className:"interface-interface-skeleton__content",role:"region","aria-label":g.body,tabIndex:"-1"},a),!!i&&(0,k.createElement)("div",{className:"interface-interface-skeleton__sidebar",role:"region","aria-label":g.sidebar,tabIndex:"-1"},i),!!c&&(0,k.createElement)("div",{className:"interface-interface-skeleton__actions",role:"region","aria-label":g.actions,tabIndex:"-1"},c))),!!n&&(0,k.createElement)("div",{className:"interface-interface-skeleton__footer",role:"region","aria-label":g.footer,tabIndex:"-1"},n))})),Ze=n(83115),Be=n(62006);function Le(e){let{as:t=Ze.Z,className:n,label:r=(0,P.__)("Options"),popoverProps:i,toggleProps:o,children:s}=e;return(0,k.createElement)(t,{className:f()("interface-more-menu-dropdown",n),icon:Be.Z,label:r,popoverProps:{position:"bottom left",...i,className:f()("interface-more-menu-dropdown__content",null==i?void 0:i.className)},toggleProps:{tooltipPosition:"bottom",...o}},(e=>s(e)))}var De=n(353),Me=n(95393),Re=n(67911),Oe=n(54600),Fe=n(17921),Ue=n(14676),Ve=n(34380),We=n(82435);const He="mailpoet/automation-editor",$e="mailpoet/automation-editor/workflow",Ge="mailpoet/automation-editor/step";var ze=n(36073);const Ke=e=>t=>{let{registry:n}=t;return n.dispatch(le).enableComplementaryArea(He,e)},Ye=()=>e=>{let{registry:t}=e;return t.dispatch(le).disableComplementaryArea(He)},qe=e=>t=>{let{registry:n}=t;return n.dispatch(K).toggle(He,e)};function Je(){return{type:"TOGGLE_INSERTER_SIDEBAR"}}function Qe(e){return{type:"SET_INSERTER_POPOVER_ANCHOR",anchor:e}}function Xe(e){return{type:"SET_SELECTED_STEP",value:e}}function et(e){const t=(0,I.select)(He).getWorkflowData();return t.name=e,{type:"UPDATE_WORKFLOW",workflow:t}}function*tt(){const e=(0,I.select)(He).getWorkflowData();return{type:"SAVE",workflow:(yield(0,ze.SC)({path:`/workflows/${e.id}`,method:"PUT",data:e})).data}}function*nt(){const e=(0,I.select)(He).getWorkflowData();return{type:"ACTIVATE",workflow:(yield(0,ze.SC)({path:`/workflows/${e.id}`,method:"PUT",data:{...e,status:"active"}})).data}}function rt(e){return{type:"REGISTER_STEP_TYPE",stepType:e}}function it(e,t,n){return{type:"UPDATE_STEP_ARGS",stepId:e,name:t,value:n}}const ot={stepTypes:{},workflowData:{...window.mailpoet_automation_workflow},workflowSaved:!0,selectedStep:void 0,inserterSidebar:{isOpened:!1},inserterPopover:{anchor:void 0}},st=(0,re.M)((e=>(t,n)=>e(K).get(He,n))),at=(0,re.M)((e=>()=>!!e(le).getActiveComplementaryArea(He)));function lt(e){return e.inserterSidebar.isOpened}function ct(e){return Object.values(e.stepTypes).filter((e=>{let{group:t}=e;return"actions"===t}))}function ut(e){return Object.values(e.stepTypes).filter((e=>{let{group:t}=e;return"logical"===t}))}function dt(e){return e.inserterPopover.anchor}function pt(e){return e.workflowData}function mt(e){return e.workflowSaved}function ft(e){return e.selectedStep}function gt(e,t){return e.stepTypes[t]??void 0}function ht(e){var t;return gt(e,null===(t=e.selectedStep)||void 0===t?void 0:t.key)}const vt=(0,Z.Z)(He,{actions:c,controls:ze.ai,selectors:u,reducer:function(e,t){switch(t.type){case"TOGGLE_INSERTER_SIDEBAR":return{...e,inserterSidebar:{...e.inserterSidebar,isOpened:!e.inserterSidebar.isOpened}};case"SET_INSERTER_POPOVER_ANCHOR":return{...e,inserterPopover:{...e.inserterPopover,anchor:t.anchor}};case"SET_SELECTED_STEP":return{...e,selectedStep:t.value};case"UPDATE_WORKFLOW":return{...e,workflowData:t.workflow,workflowSaved:!1};case"SAVE":case"ACTIVATE":return{...e,workflowData:t.workflow,workflowSaved:!0};case"REGISTER_STEP_TYPE":return{...e,stepTypes:{...e.stepTypes,[t.stepType.key]:t.stepType}};case"UPDATE_STEP_ARGS":{const n=e.workflowData.steps[t.stepId].args??{},r="function"==typeof t.value?t.value(n[t.name]??void 0):t.value,i={...n,[t.name]:r},o={...e.workflowData.steps[t.stepId],args:i};return{...e,workflowData:{...e.workflowData,steps:{...e.workflowData.steps,[t.stepId]:o}},workflowSaved:!1,selectedStep:o}}default:return e}},initialState:ot});(0,I.register)(vt);const _t=e=>{(0,I.dispatch)(vt).registerStepType(e)};var bt=n(41325),yt=n(20264);const kt=Fe.Z;function St(e){let{children:t}=e;const{workflowName:n,workflowStatus:r,showIconLabels:i}=(0,y.Z)((e=>({workflowName:e(vt).getWorkflowData().name,workflowStatus:e(vt).getWorkflowData().status,showIconLabels:e(vt).isFeatureActive("showIconLabels")})),[]),o=(0,k.useRef)();let s="mailpoet-automation-editor-chip-gray";return r===bt.x.ACTIVE?s="mailpoet-automation-editor-chip-success":r===bt.x.INACTIVE&&(s="mailpoet-automation-editor-chip-danger"),(0,yt.jsx)("div",{className:"edit-site-document-actions has-secondary-label",children:(0,yt.jsx)("div",{ref:o,className:"edit-site-document-actions__title-wrapper",children:t&&(0,yt.jsx)(kt,{popoverProps:{anchorRef:o.current},position:"bottom center",renderToggle:e=>{let{isOpen:t,onToggle:o}=e;return(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("a",{className:"mailpoet-automation-editor-dropdown-toggle-link",href:"#",onClick:o,children:[(0,yt.jsxs)(Ue.Z,{size:"body",className:"edit-site-document-actions__title",as:"h1",children:[(0,yt.jsx)(Ve.Z,{as:"span",children:(0,P.__)("Editing workflow: ")}),n]}),(0,yt.jsxs)(Ue.Z,{size:"body",className:`edit-site-document-actions__secondary-item ${s}`,children:[r===bt.x.ACTIVE&&(0,P.__)("Active"),r===bt.x.INACTIVE&&(0,P.__)("Inactive"),r===bt.x.DRAFT&&(0,P.__)("Draft")]})]}),(0,yt.jsx)(v.Z,{className:"edit-site-document-actions__get-info",icon:We.Z,"aria-expanded":t,"aria-haspopup":"true",onClick:o,label:(0,P.__)("Change workflow name"),children:i&&(0,P.__)("Rename")})]})},contentClassName:"edit-site-document-actions__info-dropdown",renderContent:t})})})}var wt=n(9487),Et=n(96097);function xt(){const{isInserterOpened:e,showIconLabels:t}=(0,y.Z)((e=>({isInserterOpened:e(vt).isInserterSidebarOpened(),showIconLabels:e(vt).isFeatureActive("showIconLabels")})),[]),{toggleInserterSidebar:n}=(0,T.Z)(vt);return(0,yt.jsx)(wt.Z,{as:v.Z,className:"edit-site-header-toolbar__inserter-toggle",variant:"primary",isPressed:e,onMouseDown:e=>e.preventDefault(),onClick:n,icon:Et.Z,label:(0,P._x)("Toggle step inserter","Generic label for step inserter button"),showTooltip:!t,children:t&&(e?(0,P.__)("Close"):(0,P.__)("Add"))})}var Tt=n(53703),Pt=n(83830),jt=n(45538);function Ct(e){let{scope:t,name:n,label:r,info:i,messageActivated:o,messageDeactivated:s,shortcut:a}=e;const l=(0,y.Z)((e=>!!e(K).get(t,n)),[n]),{toggle:c}=(0,T.Z)(K);return(0,k.createElement)(ve.Z,{icon:l&&j.Z,isSelected:l,onClick:()=>{c(t,n),(()=>{if(l){const e=s||(0,P.sprintf)((0,P.__)("Preference deactivated - %s"),r);(0,jt.D)(e)}else{const e=o||(0,P.sprintf)((0,P.__)("Preference activated - %s"),r);(0,jt.D)(e)}})()},role:"menuitemcheckbox",info:i,shortcut:a},r)}function Nt(){return(0,yt.jsx)(Le,{className:"edit-site-more-menu",popoverProps:{className:"edit-site-more-menu__content"},children:()=>(0,yt.jsx)(Tt.Z,{label:(0,P._x)("View","noun"),children:(0,yt.jsx)(Ct,{scope:He,name:"fullscreenMode",label:(0,P.__)("Fullscreen mode"),info:(0,P.__)("Work without distraction"),messageActivated:(0,P.__)("Fullscreen mode activated"),messageDeactivated:(0,P.__)("Fullscreen mode deactivated"),shortcut:Pt.displayShortcut.secondary("f")})})})}function At(){const{activate:e}=(0,T.Z)(vt);return(0,yt.jsx)(v.Z,{isPrimary:!0,className:"editor-post-publish-button",onClick:e,children:"Activate"})}function It(){const{activate:e}=(0,T.Z)(vt);return(0,yt.jsx)(v.Z,{isPrimary:!0,className:"editor-post-publish-button",onClick:e,children:"Update"})}function Zt(){const{save:e}=(0,T.Z)(vt);return(0,yt.jsx)(v.Z,{isTertiary:!0,onClick:e,children:(0,P.__)("Save Draft")})}function Bt(){const{setWorkflowName:e}=(0,T.Z)(vt),{workflowName:t,workflowStatus:n}=(0,y.Z)((e=>({workflowName:e(vt).getWorkflowData().name,workflowStatus:e(vt).getWorkflowData().status})),[]);return(0,yt.jsxs)("div",{className:"edit-site-header",children:[(0,yt.jsx)("div",{className:"edit-site-header_start",children:(0,yt.jsx)(Re.Z,{className:"edit-site-header__toolbar",orientation:"horizontal",role:"toolbar",children:(0,yt.jsx)(xt,{})})}),(0,yt.jsx)("div",{className:"edit-site-header_center",children:(0,yt.jsx)(St,{children:()=>(0,yt.jsxs)("div",{className:"mailpoet-automation-editor-dropdown-name-edit",children:[(0,yt.jsx)("div",{className:"mailpoet-automation-editor-dropdown-name-edit-title",children:(0,P.__)("Automation name")}),(0,yt.jsx)(Oe.Z,{value:t,onChange:t=>e(t),help:(0,P.__)('Give the automation a name that indicates its purpose. E.g. "Abandoned cart recovery"')})]})})}),(0,yt.jsx)("div",{className:"edit-site-header_end",children:(0,yt.jsxs)("div",{className:"edit-site-header__actions",children:[(0,yt.jsx)(Zt,{}),n!==bt.x.ACTIVE&&(0,yt.jsx)(At,{}),n===bt.x.ACTIVE&&(0,yt.jsx)(It,{}),(0,yt.jsx)(xe.Slot,{scope:He}),(0,yt.jsx)(Nt,{})]})})]})}var Lt=n(2637),Dt=n(47842),Mt=n(1779);function Rt(e){let{icon:t}=e;return(0,yt.jsx)("span",{className:"block-editor-block-icon",children:(0,yt.jsx)(_.Z,{icon:t})})}function Ot(e){let{item:t}=e;const{title:n,icon:r,description:i}=t;return(0,yt.jsx)("div",{className:"block-editor-inserter__preview-container",children:(0,yt.jsxs)("div",{className:"block-editor-block-card",children:[(0,yt.jsx)(Rt,{icon:r}),(0,yt.jsxs)("div",{className:"block-editor-block-card__content",children:[(0,yt.jsx)("h2",{className:"block-editor-block-card__title",children:n}),(0,yt.jsx)("span",{className:"block-editor-block-card__description",children:i})]})]})})}var Ft=n(88565);const Ut=(0,k.createContext)(void 0),Vt=(0,k.forwardRef)(((e,t)=>{let{isFirst:n,children:r,...i}=e;const o=(0,k.useContext)(Ut);return(0,yt.jsx)(Ft.A,{ref:t,state:o,role:"option",focusable:!0,...i,children:e=>{const t={...e,tabIndex:n?0:e.tabIndex};return(0,yt.jsx)(v.Z,{...t,children:r})}})})),Wt=()=>{const{platform:e}=window.navigator;return-1!==e.indexOf("Mac")||["iPad","iPhone"].includes(e)},Ht=(0,k.memo)((e=>{let{className:t,isFirst:n,item:r,onSelect:i,onHover:o,isDraggable:s,...a}=e;const l=(0,k.useRef)(!1);return(0,yt.jsx)("div",{className:"block-editor-block-types-list__list-item",children:(0,yt.jsxs)(Vt,{isFirst:n,className:f()("block-editor-block-types-list__item",t),disabled:r.isDisabled,onClick:e=>{e.preventDefault(),i(r,Wt()?e.metaKey:e.ctrlKey),o(null)},onKeyDown:e=>{const{keyCode:t}=e;t===Pt.ENTER&&(e.preventDefault(),i(r,Wt()?e.metaKey:e.ctrlKey),o(null))},onFocus:()=>{l.current||o(r)},onMouseEnter:()=>{l.current||o(r)},onMouseLeave:()=>o(null),onBlur:()=>o(null),...a,children:[(0,yt.jsx)("span",{className:"block-editor-block-types-list__item-icon",children:(0,yt.jsx)(Rt,{icon:r.icon})}),(0,yt.jsx)("span",{className:"block-editor-block-types-list__item-title",children:r.title})]})})})),$t=(0,k.forwardRef)(((e,t)=>{const[n,r]=(0,k.useState)(!1);return(0,k.useEffect)((()=>{n&&(0,jt.D)((0,P.__)("Use left and right arrow keys to move through blocks"))}),[n]),(0,yt.jsx)("div",{ref:t,role:"listbox","aria-orientation":"horizontal",onFocus:()=>{r(!0)},onBlur:e=>{!e.currentTarget.contains(e.relatedTarget)&&r(!1)},...e})}));var Gt=n(17750);const zt=(0,k.forwardRef)(((e,t)=>{const n=(0,k.useContext)(Ut);return(0,yt.jsx)(Gt.E,{state:n,role:"presentation",ref:t,...e})})),Kt=(e,t)=>{const n=[];for(let r=0,i=e.length;r<i;r+=t)n.push(e.slice(r,r+t));return n};function Yt(e){let{items:t,onSelect:n,onHover:r,label:i,isDraggable:o=!0,children:s}=e;return(0,yt.jsxs)($t,{className:"block-editor-block-types-list","aria-label":i,children:[Kt(t,3).map(((e,t)=>(0,yt.jsx)(zt,{children:e.map(((e,i)=>{return(0,yt.jsx)(Ht,{item:e,className:(s=e.key,`editor-block-list-item-${s.replace(/\//,"-")}`),onSelect:n,onHover:r,isDraggable:o,isFirst:0===t&&0===i},e.key);var s}))},t))),s]})}var qt=n(15596);function Jt(e){let{children:t}=e;const n=(0,qt.u)({shift:!0,wrap:"horizontal"});return(0,yt.jsx)(Ut.Provider,{value:n,children:t})}const Qt=(e,t)=>t.filter((t=>t.title.toLowerCase().includes(e.trim().toLowerCase()))),Xt=(0,k.forwardRef)(((e,t)=>{const[n,r]=(0,k.useState)(""),[i,o]=(0,k.useState)(null),{actionSteps:s,logicalSteps:a}=(0,y.Z)((e=>({actionSteps:e(vt).getInserterActionSteps(),logicalSteps:e(vt).getInserterLogicalSteps()})),[]),l=(0,k.useCallback)((e=>{o(e)}),[o]),c=(0,k.useRef)();(0,k.useImperativeHandle)(t,(()=>({focusSearch:()=>{var e;null===(e=c.current)||void 0===e||e.focus()}})));const u=(0,k.useMemo)((()=>Qt(n,s)),[s,n]),d=(0,k.useMemo)((()=>Qt(n,a)),[n,a]);return(0,yt.jsxs)("div",{className:"block-editor-inserter__menu",children:[(0,yt.jsx)("div",{className:"block-editor-inserter__main-area",children:(0,yt.jsxs)("div",{className:"block-editor-inserter__content",children:[(0,yt.jsx)(Lt.Z,{className:"block-editor-inserter__search",onChange:e=>{i&&o(null),r(e)},value:n,label:(0,P.__)("Search for blocks and patterns"),placeholder:(0,P.__)("Search"),ref:c}),(0,yt.jsx)("div",{className:"block-editor-inserter__block-list",children:(0,yt.jsxs)(Jt,{children:[u.length>0&&(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("div",{className:"block-editor-inserter__panel-header",children:(0,yt.jsx)("h2",{className:"block-editor-inserter__panel-title",children:(0,yt.jsx)("div",{children:"Actions"})})}),(0,yt.jsx)("div",{className:"block-editor-inserter__panel-content",children:(0,yt.jsx)(Yt,{items:u,onHover:l,onSelect:()=>{},label:"A"})})]}),d.length>0&&(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("div",{className:"block-editor-inserter__panel-header",children:(0,yt.jsx)("h2",{className:"block-editor-inserter__panel-title",children:(0,yt.jsx)("div",{children:"Logical"})})}),(0,yt.jsx)("div",{className:"block-editor-inserter__panel-content",children:(0,yt.jsx)(Yt,{items:d,onHover:l,onSelect:()=>{},label:"B"})})]}),0===u.length&&0===d.length&&(0,yt.jsxs)("div",{className:"block-editor-inserter__no-results",children:[(0,yt.jsx)(Dt.Z,{className:"block-editor-inserter__no-results-icon",icon:Mt.Z}),(0,yt.jsx)("p",{children:(0,P.__)("No results found.")})]})]})})]})}),i&&(0,yt.jsx)(Ot,{item:i})]})}));function en(){return(0,yt.jsx)("div",{className:"edit-site-editor__inserter-panel",children:(0,yt.jsx)("div",{className:"edit-site-editor__inserter-panel-content",children:(0,yt.jsx)(Xt,{})})})}function tn(){const{isSidebarOpened:e,selectedStep:t}=(0,y.Z)((e=>({isSidebarOpened:e(vt).isSidebarOpened,selectedStep:e(vt).getSelectedStep}))),{openSidebar:n,closeSidebar:r,toggleFeature:i}=(0,T.Z)(vt),{registerShortcut:o}=(0,T.Z)(De.h);return(0,k.useEffect)((()=>{o({name:"mailpoet/automation-editor/toggle-fullscreen",category:"global",description:(0,P.__)("Toggle fullscreen mode."),keyCombination:{modifier:"secondary",character:"f"}}),o({name:"mailpoet/automation-editor/toggle-sidebar",category:"global",description:(0,P.__)("Show or hide the settings sidebar."),keyCombination:{modifier:"primaryShift",character:","}})}),[o]),(0,De.bx)("mailpoet/automation-editor/toggle-fullscreen",(()=>{i("fullscreenMode")})),(0,De.bx)("mailpoet/automation-editor/toggle-sidebar",(i=>{if(i.preventDefault(),e())r();else{const e=t()?Ge:$e;n(e)}})),null}var nn=n(12518),rn=(0,k.createElement)(S.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,k.createElement)(S.y$,{fillRule:"evenodd",d:"M10.289 4.836A1 1 0 0111.275 4h1.306a1 1 0 01.987.836l.244 1.466c.787.26 1.503.679 2.108 1.218l1.393-.522a1 1 0 011.216.437l.653 1.13a1 1 0 01-.23 1.273l-1.148.944a6.025 6.025 0 010 2.435l1.149.946a1 1 0 01.23 1.272l-.653 1.13a1 1 0 01-1.216.437l-1.394-.522c-.605.54-1.32.958-2.108 1.218l-.244 1.466a1 1 0 01-.987.836h-1.306a1 1 0 01-.986-.836l-.244-1.466a5.995 5.995 0 01-2.108-1.218l-1.394.522a1 1 0 01-1.217-.436l-.653-1.131a1 1 0 01.23-1.272l1.149-.946a6.026 6.026 0 010-2.435l-1.148-.944a1 1 0 01-.23-1.272l.653-1.131a1 1 0 011.217-.437l1.393.522a5.994 5.994 0 012.108-1.218l.244-1.466zM14.929 12a3 3 0 11-6 0 3 3 0 016 0z",clipRule:"evenodd"}));function on(e){let{sidebarKey:t}=e;const{openSidebar:n}=(0,T.Z)(vt),[r,i]=t===$e?["Workflow (selected)","is-active"]:["Workflow",""],[o,s]=t===Ge?["Step (selected)","is-active"]:["Step",""];return(0,yt.jsxs)("ul",{children:[(0,yt.jsx)("li",{children:(0,yt.jsx)(v.Z,{onClick:()=>n($e),className:`edit-site-sidebar__panel-tab ${i}`,"aria-label":r,"data-label":"Workflow",children:"Workflow"})}),(0,yt.jsx)("li",{children:(0,yt.jsx)(v.Z,{onClick:()=>n(Ge),className:`edit-site-sidebar__panel-tab ${s}`,"aria-label":o,"data-label":"Workflow",children:"Step"})})]})}var sn=n(21840);function an(e){let{title:t,description:n,icon:r}=e;return(0,yt.jsxs)("div",{className:"block-editor-block-card",children:[(0,yt.jsx)(Rt,{icon:r}),(0,yt.jsxs)("div",{className:"block-editor-block-card__content",children:[(0,yt.jsx)("h2",{className:"block-editor-block-card__title",children:t}),(0,yt.jsx)("span",{className:"block-editor-block-card__description",children:n})]})]})}function ln(){const{selectedStep:e,selectedStepType:t}=(0,y.Z)((e=>({selectedStep:e(vt).getSelectedStep(),selectedStepType:e(vt).getSelectedStepType()})),[]);if(!e)return(0,yt.jsx)(sn.Z,{children:"No step selected."});if(!t)return(0,yt.jsx)(sn.Z,{children:"Unknown step type."});const n=t.edit;return(0,yt.jsxs)("div",{className:"block-editor-block-inspector",children:[(0,yt.jsx)(an,{title:t.title,description:t.description,icon:t.icon}),(0,yt.jsx)(n,{}),(0,yt.jsxs)(sn.Z,{title:"Debug info",initialOpen:!1,children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("strong",{children:"ID:"})," ",e.id]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("strong",{children:"Type:"})," ",e.type]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("strong",{children:"Key:"})," ",e.key]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("strong",{children:"Args:"})," ",JSON.stringify(e.args)]})]})]})}var cn=n(11345),un=n(34206),dn=n(18439),pn=n(31539),mn=n(62668),fn=n(53397);function gn(){const{createErrorNotice:e}=(0,T.Z)(dn.h),{workflow:t}=(0,y.Z)((e=>({workflow:e(vt).getWorkflowData()})),[]);return(0,yt.jsx)(v.Z,{isSecondary:!0,isDestructive:!0,onClick:()=>{(0,pn._)({title:"Delete workflow",message:`You are about to delete the “${t.name}” workflow`,cancelLabel:"Cancel",confirmLabel:"Yes, delete",onConfirm:()=>{(0,un.default)({path:`/workflows/${t.id}`,method:"PUT",data:{...t,status:"trash"}}).then((n=>{let{data:r}=n;"trash"===r.status?window.location.href=(0,Me.f)(mn.x.urls.automationListing,{[fn.E.workflowDeleted]:t.id}):e("An error occurred!",{explicitDismiss:!0})})).catch((()=>{e("An error occurred!",{explicitDismiss:!0})}))}})},children:"Move to Trash"})}function hn(){const{workflowData:e}=(0,y.Z)((e=>({workflowData:e(vt).getWorkflowData()})),[]),t={year:"numeric",month:"long",day:"numeric"};return(0,yt.jsxs)(sn.Z,{title:"Automation details",initialOpen:!0,children:[(0,yt.jsxs)(cn.Z,{children:[(0,yt.jsx)("strong",{children:"Date added"})," ",new Date(Date.parse(e.created_at)).toLocaleDateString(void 0,t)]}),(0,yt.jsxs)(cn.Z,{children:[(0,yt.jsx)("strong",{children:"Activated"})," ","active"===e.status&&new Date(Date.parse(e.updated_at)).toLocaleDateString(void 0,t),"active"!==e.status&&e.activated_at&&new Date(Date.parse(e.activated_at)).toLocaleDateString(void 0,t),"active"!==e.status&&!e.activated_at&&(0,yt.jsx)("span",{className:"mailpoet-deactive",children:"Not activated yet."})]}),(0,yt.jsxs)(cn.Z,{children:[(0,yt.jsx)("strong",{children:"Author"})," ",e.author.name]}),(0,yt.jsx)(cn.Z,{children:(0,yt.jsx)(gn,{})})]})}const vn=nn.Z.select({web:!0,native:!1});function _n(e){const{keyboardShortcut:t,sidebarKey:n,showIconLabels:r,workflowName:i}=(0,y.Z)((e=>({keyboardShortcut:e(De.h).getShortcutRepresentation("mailpoet/automation-editor/toggle-sidebar"),sidebarKey:e(le).getActiveComplementaryArea(He)??$e,showIconLabels:e(vt).isFeatureActive("showIconLabels"),workflowName:e(vt).getWorkflowData().name})),[]);return(0,yt.jsxs)(je,{identifier:n,header:(0,yt.jsx)(on,{sidebarKey:n}),closeLabel:(0,P.__)("Close settings"),headerClassName:"edit-site-sidebar__panel-tabs",title:(0,P.__)("Settings"),icon:rn,className:"edit-site-sidebar",panelClassName:"edit-site-sidebar",smallScreenTitle:i||(0,P.__)("(no title)"),scope:He,toggleShortcut:t,isActiveByDefault:vn,showIconLabels:r,...e,children:[n===$e&&(0,yt.jsx)(hn,{}),n===Ge&&(0,yt.jsx)(ln,{})]})}var bn=n(73763),yn=n(74996),kn=n(81963),Sn=n(67257);const wn={...Sn.w0,richEditingEnabled:!0,codeEditingEnabled:!0,enableCustomFields:void 0,supportsLayout:!0};function En(e){return e&&"object"==typeof e&&"raw"in e?e.raw:e}var xn=F()({postId:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return"SETUP_EDITOR_STATE"===t.type?t.post.id:e},postType:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return"SETUP_EDITOR_STATE"===t.type?t.post.type:e},saving:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REQUEST_POST_UPDATE_START":case"REQUEST_POST_UPDATE_FINISH":return{pending:"REQUEST_POST_UPDATE_START"===t.type,options:t.options||{}}}return e},postLock:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isLocked:!1},t=arguments.length>1?arguments[1]:void 0;return"UPDATE_POST_LOCK"===t.type?t.lock:e},template:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isValid:!0},t=arguments.length>1?arguments[1]:void 0;return"SET_TEMPLATE_VALIDITY"===t.type?{...e,isValid:t.isValid}:e},postSavingLock:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOCK_POST_SAVING":return{...e,[t.lockName]:!0};case"UNLOCK_POST_SAVING":return(0,A.omit)(e,t.lockName)}return e},isReady:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SETUP_EDITOR_STATE":return!0;case"TEAR_DOWN_EDITOR":return!1}return e},editorSettings:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wn,t=arguments.length>1?arguments[1]:void 0;return"UPDATE_EDITOR_SETTINGS"===t.type?{...e,...t.settings}:e},postAutosavingLock:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOCK_POST_AUTOSAVING":return{...e,[t.lockName]:!0};case"UNLOCK_POST_AUTOSAVING":return(0,A.omit)(e,t.lockName)}return e}}),Tn=n(6870),Pn=n(51691),jn=n(14462),Cn=n(53785);const Nn=new Set(["meta"]),An="SAVE_POST_NOTICE_ID",In="TRASH_POST_NOTICE_ID",Zn=/%(?:postname|pagename)%/,Bn=["title","excerpt","content"];var Ln=(0,k.createElement)(S.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,k.createElement)(S.y$,{d:"M18.5 10.5H10v8h8a.5.5 0 00.5-.5v-7.5zm-10 0h-3V18a.5.5 0 00.5.5h2.5v-8zM6 4h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2z"})),Dn=(0,k.createElement)(S.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,k.createElement)(S.y$,{fillRule:"evenodd",d:"M18 5.5h-8v8h8.5V6a.5.5 0 00-.5-.5zm-9.5 8h-3V6a.5.5 0 01.5-.5h2.5v8zM6 4h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2z"})),Mn=(0,k.createElement)(S.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,k.createElement)(S.y$,{d:"M18 5.5H6a.5.5 0 00-.5.5v3h13V6a.5.5 0 00-.5-.5zm.5 5H10v8h8a.5.5 0 00.5-.5v-7.5zM6 4h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2z"})),Rn=(0,k.createElement)(S.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,k.createElement)(S.y$,{d:"M21.3 10.8l-5.6-5.6c-.7-.7-1.8-.7-2.5 0l-5.6 5.6c-.7.7-.7 1.8 0 2.5l5.6 5.6c.3.3.8.5 1.2.5s.9-.2 1.2-.5l5.6-5.6c.8-.7.8-1.9.1-2.5zm-17.6 1L10 5.5l-1-1-6.3 6.3c-.7.7-.7 1.8 0 2.5L9 19.5l1.1-1.1-6.3-6.3c-.2 0-.2-.2-.1-.3z"}));const On={},Fn=[],Un=(0,re.M)((e=>()=>e(kn.h).hasUndo())),Vn=(0,re.M)((e=>()=>e(kn.h).hasRedo()));function Wn(e){return"auto-draft"===Kn(e).status}function Hn(e){const t=Xn(e);return"blocks"in t||"content"in t}const $n=(0,re.M)((e=>t=>{const n=Yn(t),r=qn(t);return!!e(kn.h).hasEditsForEntityRecord("postType",n,r)})),Gn=(0,re.M)((e=>t=>{const n=e(kn.h).__experimentalGetDirtyEntityRecords(),{type:r,id:i}=Kn(t);return(0,A.some)(n,(e=>"postType"!==e.kind||e.name!==r||e.key!==i))}));function zn(e){return!$n(e)&&Wn(e)}const Kn=(0,re.M)((e=>t=>{const n=qn(t),r=Yn(t);return e(kn.h).getRawEntityRecord("postType",r,n)||On}));function Yn(e){return e.postType}function qn(e){return e.postId}function Jn(e){return(0,A.get)(Kn(e),["_links","version-history",0,"count"],0)}function Qn(e){return(0,A.get)(Kn(e),["_links","predecessor-version",0,"id"],null)}const Xn=(0,re.M)((e=>t=>{const n=Yn(t),r=qn(t);return e(kn.h).getEntityRecordEdits("postType",n,r)||On}));function er(e,t){switch(t){case"type":return Yn(e);case"id":return qn(e);default:const n=Kn(e);if(!n.hasOwnProperty(t))break;return En(n[t])}}function tr(e,t){if("content"===t)return kr(e);const n=Xn(e);return n.hasOwnProperty(t)?Nn.has(t)?((e,t)=>{const n=Xn(e);return n.hasOwnProperty(t)?{...er(e,t),...n[t]}:er(e,t)})(e,t):n[t]:er(e,t)}const nr=(0,re.M)((e=>(t,n)=>{if(!(0,A.includes)(Bn,n)&&"preview_link"!==n)return;const r=Yn(t),i=qn(t),o=(0,A.get)(e(kn.h).getCurrentUser(),["id"]),s=e(kn.h).getAutosave(r,i,o);return s?En(s[n]):void 0}));function rr(e){return"private"===tr(e,"status")?"private":tr(e,"password")?"password":"public"}function ir(e){return"pending"===Kn(e).status}function or(e,t){const n=t||Kn(e);return-1!==["publish","private"].indexOf(n.status)||"future"===n.status&&!(0,Pn.gF)(new Date(Number((0,Pn._3)(n.date))-6e4))}function sr(e){return"future"===Kn(e).status&&!or(e)}function ar(e){const t=Kn(e);return $n(e)||-1===["publish","private","future"].indexOf(t.status)}function lr(e){return!(mr(e)||!tr(e,"title")&&!tr(e,"excerpt")&&cr(e)&&"native"!==nn.Z.OS)}function cr(e){const t=Lr(e);if(t.length){if(t.length>1)return!1;const e=t[0].name;if(e!==(0,yn.UT)()&&e!==(0,yn.HJ)())return!1}return!kr(e)}const ur=(0,re.M)((e=>t=>{if(!lr(t))return!1;if(Cr(t))return!1;const n=Yn(t),r=qn(t),i=e(kn.h).hasFetchedAutosaves(n,r),o=(0,A.get)(e(kn.h).getCurrentUser(),["id"]),s=e(kn.h).getAutosave(n,r,o);return!!i&&(!s||!!Hn(t)||["title","excerpt"].some((e=>En(s[e])!==tr(t,e))))}));function dr(e){const t=tr(e,"date"),n=new Date(Number((0,Pn._3)(t))-6e4);return(0,Pn.gF)(n)}function pr(e){const t=tr(e,"date"),n=tr(e,"modified"),r=Kn(e).status;return!("draft"!==r&&"auto-draft"!==r&&"pending"!==r||t!==n&&null!==t)}const mr=(0,re.M)((e=>t=>{const n=Yn(t),r=qn(t);return e(kn.h).isSavingEntityRecord("postType",n,r)})),fr=(0,re.M)((e=>t=>{const n=e(kn.h).__experimentalGetEntitiesBeingSaved(),{type:r,id:i}=Kn(t);return(0,A.some)(n,(e=>"postType"!==e.kind||e.name!==r||e.key!==i))})),gr=(0,re.M)((e=>t=>{const n=Yn(t),r=qn(t);return!e(kn.h).getLastEntitySaveError("postType",n,r)})),hr=(0,re.M)((e=>t=>{const n=Yn(t),r=qn(t);return!!e(kn.h).getLastEntitySaveError("postType",n,r)}));function vr(e){return!!mr(e)&&!!(0,A.get)(e.saving,["options","isAutosave"])}function _r(e){return!!mr(e)&&!!(0,A.get)(e.saving,["options","isPreview"])}function br(e){if(e.saving.pending||mr(e))return;let t=nr(e,"preview_link");t&&"draft"!==Kn(e).status||(t=tr(e,"link"),t&&(t=(0,Me.f)(t,{preview:!0})));const n=tr(e,"featured_media");return t&&n?(0,Me.f)(t,{_thumbnail_id:n}):t}function yr(e){const t=Lr(e);if(t.length>2)return null;let n;if(1===t.length&&(n=t[0].name,"core/embed"===n)){var r;const e=null===(r=t[0].attributes)||void 0===r?void 0:r.providerNameSlug;["youtube","vimeo"].includes(e)?n="core/video":["spotify","soundcloud"].includes(e)&&(n="core/audio")}switch(2===t.length&&"core/paragraph"===t[1].name&&(n=t[0].name),n){case"core/image":return"image";case"core/quote":case"core/pullquote":return"quote";case"core/gallery":return"gallery";case"core/video":return"video";case"core/audio":return"audio";default:return null}}const kr=(0,re.M)((e=>t=>{const n=qn(t),r=Yn(t),i=e(kn.h).getEditedEntityRecord("postType",r,n);if(i){if("function"==typeof i.content)return i.content(i);if(i.blocks)return(0,yn.qm)(i.blocks);if(i.content)return i.content}return""}));function Sr(e){return mr(e)&&!or(e)&&"publish"===tr(e,"status")}function wr(e){const t=tr(e,"permalink_template");return Zn.test(t)}function Er(e){const t=Tr(e);if(!t)return null;const{prefix:n,postName:r,suffix:i}=t;return wr(e)?n+r+i:n}function xr(e){return tr(e,"slug")||(0,jn.J)(tr(e,"title"))||qn(e)}function Tr(e){const t=tr(e,"permalink_template");if(!t)return null;const n=tr(e,"slug")||tr(e,"generated_slug"),[r,i]=t.split(Zn);return{prefix:r,postName:n,suffix:i}}function Pr(e){return e.postLock.isLocked}function jr(e){return Object.keys(e.postSavingLock).length>0}function Cr(e){return Object.keys(e.postAutosavingLock).length>0}function Nr(e){return e.postLock.isTakeover}function Ar(e){return e.postLock.user}function Ir(e){return e.postLock.activePostLock}function Zr(e){return(0,A.has)(Kn(e),["_links","wp:action-unfiltered-html"])}const Br=(0,re.M)((e=>()=>!!e(K).get("core/edit-post","isPublishSidebarEnabled")));function Lr(e){return tr(e,"blocks")||Fn}function Dr(e){var t;return(0,R.Z)("select('core/editor').getEditorSelectionStart",{since:"5.8",alternative:"select('core/editor').getEditorSelection"}),null===(t=tr(e,"selection"))||void 0===t?void 0:t.selectionStart}function Mr(e){var t;return(0,R.Z)("select('core/editor').getEditorSelectionStart",{since:"5.8",alternative:"select('core/editor').getEditorSelection"}),null===(t=tr(e,"selection"))||void 0===t?void 0:t.selectionEnd}function Rr(e){return tr(e,"selection")}function Or(e){return e.isReady}function Fr(e){return e.editorSettings}function Ur(){return(0,R.Z)("select('core/editor').getStateBeforeOptimisticTransaction",{since:"5.7",hint:"No state history is kept on this store anymore"}),null}function Vr(){return(0,R.Z)("select('core/editor').inSomeHistory",{since:"5.7",hint:"No state history is kept on this store anymore"}),!1}function Wr(e){return(0,re.M)((t=>function(n){(0,R.Z)("`wp.data.select( 'core/editor' )."+e+"`",{since:"5.3",alternative:"`wp.data.select( 'core/block-editor' )."+e+"`",version:"6.2"});for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return t(Sn.t2)[e](...i)}))}const Hr=Wr("getBlockName"),$r=Wr("isBlockValid"),Gr=Wr("getBlockAttributes"),zr=Wr("getBlock"),Kr=Wr("getBlocks"),Yr=Wr("getClientIdsOfDescendants"),qr=Wr("getClientIdsWithDescendants"),Jr=Wr("getGlobalBlockCount"),Qr=Wr("getBlocksByClientId"),Xr=Wr("getBlockCount"),ei=Wr("getBlockSelectionStart"),ti=Wr("getBlockSelectionEnd"),ni=Wr("getSelectedBlockCount"),ri=Wr("hasSelectedBlock"),ii=Wr("getSelectedBlockClientId"),oi=Wr("getSelectedBlock"),si=Wr("getBlockRootClientId"),ai=Wr("getBlockHierarchyRootClientId"),li=Wr("getAdjacentBlockClientId"),ci=Wr("getPreviousBlockClientId"),ui=Wr("getNextBlockClientId"),di=Wr("getSelectedBlocksInitialCaretPosition"),pi=Wr("getMultiSelectedBlockClientIds"),mi=Wr("getMultiSelectedBlocks"),fi=Wr("getFirstMultiSelectedBlockClientId"),gi=Wr("getLastMultiSelectedBlockClientId"),hi=Wr("isFirstMultiSelectedBlock"),vi=Wr("isBlockMultiSelected"),_i=Wr("isAncestorMultiSelected"),bi=Wr("getMultiSelectedBlocksStartClientId"),yi=Wr("getMultiSelectedBlocksEndClientId"),ki=Wr("getBlockOrder"),Si=Wr("getBlockIndex"),wi=Wr("isBlockSelected"),Ei=Wr("hasSelectedInnerBlock"),xi=Wr("isBlockWithinSelection"),Ti=Wr("hasMultiSelection"),Pi=Wr("isMultiSelecting"),ji=Wr("isSelectionEnabled"),Ci=Wr("getBlockMode"),Ni=Wr("isTyping"),Ai=Wr("isCaretWithinFormattedText"),Ii=Wr("getBlockInsertionPoint"),Zi=Wr("isBlockInsertionPointVisible"),Bi=Wr("isValidTemplate"),Li=Wr("getTemplate"),Di=Wr("getTemplateLock"),Mi=Wr("canInsertBlockType"),Ri=Wr("getInserterItems"),Oi=Wr("hasInserterItems"),Fi=Wr("getBlockListSettings");function Ui(e){var t;return null===(t=Fr(e))||void 0===t?void 0:t.defaultTemplateTypes}const Vi=(0,Tn.Z)((e=>{var t;const n=(null===(t=Fr(e))||void 0===t?void 0:t.defaultTemplatePartAreas)||[];return null==n?void 0:n.map((e=>{return{...e,icon:(t=e.icon,"header"===t?Ln:"footer"===t?Dn:"sidebar"===t?Mn:Rn)};var t}))}),(e=>{var t;return[null===(t=Fr(e))||void 0===t?void 0:t.defaultTemplatePartAreas]})),Wi=(0,Tn.Z)(((e,t)=>(0,A.find)(Ui(e),{slug:t})||{}),((e,t)=>[Ui(e),t]));function Hi(e,t){var n;if(!t)return{};const{description:r,slug:i,title:o,area:s}=t,{title:a,description:l}=Wi(e,i),c="string"==typeof o?o:null==o?void 0:o.rendered;return{title:c&&c!==i?c:a||i,description:("string"==typeof r?r:null==r?void 0:r.raw)||l,icon:(null===(n=Vi(e).find((e=>s===e.area)))||void 0===n?void 0:n.icon)||Cn.Z}}const $i=(0,re.M)((e=>t=>{var n;const r=Yn(t),i=e(kn.h).getPostType(r);return null==i||null===(n=i.labels)||void 0===n?void 0:n.singular_name}));function Gi(e,t,n,r,i){window.sessionStorage.setItem(function(e,t){return`wp-autosave-block-editor-post-${t?"auto-draft":e}`}(e,t),JSON.stringify({post_title:n,content:r,excerpt:i}))}function zi(e){const{previousPost:t,post:n,postType:r}=e;if((0,A.get)(e.options,["isAutosave"]))return[];if("trash"===n.status&&"trash"!==t.status)return[];const i=["publish","private","future"],o=(0,A.includes)(i,t.status),s=(0,A.includes)(i,n.status);let a,l,c=(0,A.get)(r,["viewable"],!1);o||s?o&&!s?(a=r.labels.item_reverted_to_draft,c=!1):a=!o&&s?{publish:r.labels.item_published,private:r.labels.item_published_privately,future:r.labels.item_scheduled}[n.status]:r.labels.item_updated:(a=(0,P.__)("Draft saved."),l=!0);const u=[];return c&&u.push({label:l?(0,P.__)("View Preview"):r.labels.view_item,url:n.link}),[a,{id:An,type:"snackbar",actions:u}]}function Ki(e){const{post:t,edits:n,error:r}=e;if(r&&"rest_autosave_no_changes"===r.code)return[];const i=["publish","private","future"],o=-1!==i.indexOf(t.status),s={publish:(0,P.__)("Publishing failed."),private:(0,P.__)("Publishing failed."),future:(0,P.__)("Scheduling failed.")};let a=o||-1===i.indexOf(n.status)?(0,P.__)("Updating failed."):s[n.status];return r.message&&!/<\/?[^>]*>/.test(r.message)&&(a=[a,r.message].join(" ")),[a,{id:An}]}const Yi=(e,t,n)=>r=>{let{dispatch:i}=r;if(i.setupEditorState(e),"auto-draft"===e.status&&n){let r;r=(0,A.has)(t,["content"])?t.content:e.content.raw;let o=(0,yn.Qc)(r);o=(0,yn.fw)(o,n),i.resetEditorBlocks(o,{__unstableShouldCreateUndoLevel:!1})}t&&Object.values(t).some((t=>{var n,r;let[i,o]=t;return o!==(null!==(n=null===(r=e[i])||void 0===r?void 0:r.raw)&&void 0!==n?n:e[i])}))&&i.editPost(t)};function qi(){return{type:"TEAR_DOWN_EDITOR"}}function Ji(){return(0,R.Z)("wp.data.dispatch( 'core/editor' ).resetPost",{since:"6.0",version:"6.3",alternative:"Initialize the editor with the setupEditorState action"}),{type:"DO_NOTHING"}}function Qi(){return(0,R.Z)("wp.data.dispatch( 'core/editor' ).updatePost",{since:"5.7",alternative:"Use the core entities store instead"}),{type:"DO_NOTHING"}}function Xi(e){return{type:"SETUP_EDITOR_STATE",post:e}}const eo=(e,t)=>n=>{let{select:r,registry:i}=n;const{id:o,type:s}=r.getCurrentPost();i.dispatch(kn.h).editEntityRecord("postType",s,o,e,t)},to=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async t=>{let{select:n,dispatch:r,registry:i}=t;if(!n.isEditedPostSaveable())return;const o=n.getEditedPostContent();e.isAutosave||r.editPost({content:o},{undoIgnore:!0});const s=n.getCurrentPost(),a={id:s.id,...i.select(kn.h).getEntityRecordNonTransientEdits("postType",s.type,s.id),content:o};r({type:"REQUEST_POST_UPDATE_START",options:e}),await i.dispatch(kn.h).saveEntityRecord("postType",s.type,a,e),r({type:"REQUEST_POST_UPDATE_FINISH",options:e});const l=i.select(kn.h).getLastEntitySaveError("postType",s.type,s.id);if(l){const e=Ki({post:s,edits:a,error:l});e.length&&i.dispatch(dn.h).createErrorNotice(...e)}else{const t=n.getCurrentPost(),r=zi({previousPost:s,post:t,postType:await i.resolveSelect(kn.h).getPostType(t.type),options:e});r.length&&i.dispatch(dn.h).createSuccessNotice(...r),e.isAutosave||i.dispatch(Sn.t2).__unstableMarkLastChangeAsPersistent()}}};function no(){return(0,R.Z)("wp.data.dispatch( 'core/editor' ).refreshPost",{since:"6.0",version:"6.3",alternative:"Use the core entities store instead"}),{type:"DO_NOTHING"}}const ro=()=>async e=>{let{select:t,dispatch:n,registry:r}=e;const i=t.getCurrentPostType(),o=await r.resolveSelect(kn.h).getPostType(i);r.dispatch(dn.h).removeNotice(In);const{rest_base:s,rest_namespace:a="wp/v2"}=o;try{const e=t.getCurrentPost();await(0,un.default)({path:`/${a}/${s}/${e.id}`,method:"DELETE"}),await n.savePost()}catch(e){r.dispatch(dn.h).createErrorNotice(...(l={error:e},[l.error.message&&"unknown_error"!==l.error.code?l.error.message:(0,P.__)("Trashing failed"),{id:In}]))}var l},io=function(){let{local:e=!1,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async n=>{let{select:r,dispatch:i}=n;if(e){const e=r.getCurrentPost(),t=r.isEditedPostNew(),n=r.getEditedPostAttribute("title"),i=r.getEditedPostAttribute("content"),o=r.getEditedPostAttribute("excerpt");Gi(e.id,t,n,i,o)}else await i.savePost({isAutosave:!0,...t})}},oo=()=>e=>{let{registry:t}=e;t.dispatch(kn.h).redo()},so=()=>e=>{let{registry:t}=e;t.dispatch(kn.h).undo()};function ao(){return(0,R.Z)("wp.data.dispatch( 'core/editor' ).createUndoLevel",{since:"6.0",version:"6.3",alternative:"Use the core entities store instead"}),{type:"DO_NOTHING"}}function lo(e){return{type:"UPDATE_POST_LOCK",lock:e}}const co=()=>e=>{let{registry:t}=e;t.dispatch(K).set("core/edit-post","isPublishSidebarEnabled",!0)},uo=()=>e=>{let{registry:t}=e;t.dispatch(K).set("core/edit-post","isPublishSidebarEnabled",!1)};function po(e){return{type:"LOCK_POST_SAVING",lockName:e}}function mo(e){return{type:"UNLOCK_POST_SAVING",lockName:e}}function fo(e){return{type:"LOCK_POST_AUTOSAVING",lockName:e}}function go(e){return{type:"UNLOCK_POST_AUTOSAVING",lockName:e}}const ho=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{select:r,dispatch:i,registry:o}=n;const{__unstableShouldCreateUndoLevel:s,selection:a}=t,l={blocks:e,selection:a};if(!1!==s){const{id:e,type:t}=r.getCurrentPost();if(o.select(kn.h).getEditedEntityRecord("postType",t,e).blocks===l.blocks)return void o.dispatch(kn.h).__unstableCreateUndoLevel("postType",t,e);l.content=e=>{let{blocks:t=[]}=e;return(0,yn.qm)(t)}}i.editPost(l)}};function vo(e){return{type:"UPDATE_EDITOR_SETTINGS",settings:e}}const _o=e=>function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return t=>{let{registry:r}=t;(0,R.Z)("`wp.data.dispatch( 'core/editor' )."+e+"`",{since:"5.3",alternative:"`wp.data.dispatch( 'core/block-editor' )."+e+"`",version:"6.2"}),r.dispatch(Sn.t2)[e](...n)}},bo=_o("resetBlocks"),yo=_o("receiveBlocks"),ko=_o("updateBlock"),So=_o("updateBlockAttributes"),wo=_o("selectBlock"),Eo=_o("startMultiSelect"),xo=_o("stopMultiSelect"),To=_o("multiSelect"),Po=_o("clearSelectedBlock"),jo=_o("toggleSelection"),Co=_o("replaceBlocks"),No=_o("replaceBlock"),Ao=_o("moveBlocksDown"),Io=_o("moveBlocksUp"),Zo=_o("moveBlockToPosition"),Bo=_o("insertBlock"),Lo=_o("insertBlocks"),Do=_o("showInsertionPoint"),Mo=_o("hideInsertionPoint"),Ro=_o("setTemplateValidity"),Oo=_o("synchronizeTemplate"),Fo=_o("mergeBlocks"),Uo=_o("removeBlocks"),Vo=_o("removeBlock"),Wo=_o("toggleBlockMode"),Ho=_o("startTyping"),$o=_o("stopTyping"),Go=_o("enterFormattedText"),zo=_o("exitFormattedText"),Ko=_o("insertDefaultBlock"),Yo=_o("updateBlockListSettings"),qo={reducer:xn,selectors:d,actions:p},Jo=(0,Z.Z)("core/editor",{...qo});function Qo(e){const t=(0,A.mapValues)((0,A.pickBy)(e.attributes,{source:"meta"}),"meta");return(0,A.isEmpty)(t)||(e.edit=(e=>(0,ue.o)((t=>n=>{let{attributes:r,setAttributes:i,...o}=n;const s=(0,y.Z)((e=>e(Jo).getCurrentPostType()),[]),[a,l]=(0,kn.Mi)("postType",s,"meta"),c=(0,k.useMemo)((()=>({...r,...(0,A.mapValues)(e,(e=>a[e]))})),[r,a]);return(0,k.createElement)(t,(0,E.Z)({attributes:c,setAttributes:t=>{const n=(0,A.mapKeys)((0,A.pickBy)(t,((t,n)=>e[n])),((t,n)=>e[n]));(0,A.isEmpty)(n)||l(n),i(t)}},o))}),"withMetaAttributeSource"))(t)(e.edit)),e}function Xo(e){const t=e.avatar_urls&&e.avatar_urls[24]?(0,k.createElement)("img",{className:"editor-autocompleters__user-avatar",alt:"",src:e.avatar_urls[24]}):(0,k.createElement)("span",{className:"editor-autocompleters__no-avatar"});return(0,k.createElement)(k.Fragment,null,t,(0,k.createElement)("span",{className:"editor-autocompleters__user-name"},e.name),(0,k.createElement)("span",{className:"editor-autocompleters__user-slug"},e.slug))}(0,I.register)(Jo),(0,ce.KJ)("blocks.registerBlockType","core/editor/custom-sources-backwards-compatibility/shim-attribute-source",Qo),(0,I.select)(yn.h).getBlockTypes().map((e=>{let{name:t}=e;return(0,I.select)(yn.h).getBlockType(t)})).forEach(Qo);var es={name:"users",className:"editor-autocompleters__user",triggerPrefix:"@",useItems(e){const t=(0,y.Z)((t=>{const{getUsers:n}=t(kn.h);return n({context:"view",search:encodeURIComponent(e)})}),[e]),n=(0,k.useMemo)((()=>t?t.map((e=>({key:`user-${e.slug}`,value:e,label:Xo(e)}))):[]),[t]);return[n]},getOptionCompletion:e=>`@${e.slug}`};(0,ce.KJ)("editor.Autocomplete.completers","editor/autocompleters/set-default-completers",(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.push((0,A.clone)(es)),e}));var ts=n(81535),ns=n(5523),rs=n(19006),is=n(79496),os=n(99318),ss=(0,is.Z)([(0,ns.Z)((e=>({isValid:e(Sn.t2).isValidTemplate()}))),(0,rs.Z)((e=>{const{setTemplateValidity:t,synchronizeTemplate:n}=e(Sn.t2);return{resetTemplateValidity:()=>t(!0),synchronizeTemplate:n}}))])((function(e){let{isValid:t,...n}=e;return t?null:(0,k.createElement)(os.Z,{className:"editor-template-validation-notice",isDismissible:!1,status:"warning",actions:[{label:(0,P.__)("Keep it as is"),onClick:n.resetTemplateValidity},{label:(0,P.__)("Reset the template"),onClick:()=>{window.confirm((0,P.__)("Resetting the template may result in loss of content, do you want to continue?"))&&n.synchronizeTemplate()}}]},(0,P.__)("The content of your post doesn’t match the template assigned to your post type."))})),as=(0,is.Z)([(0,ns.Z)((e=>({notices:e(dn.h).getNotices()}))),(0,rs.Z)((e=>({onRemove:e(dn.h).removeNotice})))])((function(e){let{notices:t,onRemove:n}=e;const r=(0,A.filter)(t,{isDismissible:!0,type:"default"}),i=(0,A.filter)(t,{isDismissible:!1,type:"default"});return(0,k.createElement)(k.Fragment,null,(0,k.createElement)(ts.Z,{notices:i,className:"components-editor-notices__pinned"}),(0,k.createElement)(ts.Z,{notices:r,className:"components-editor-notices__dismissible",onRemove:n},(0,k.createElement)(ss,null)))}));const ls=(0,k.createContext)(void 0);function cs(){return(0,yt.jsx)("div",{className:"mailpoet-automation-editor-empty-workflow",children:"No workflow data."})}function us(e){let{onClick:t}=e;const n=(0,k.useContext)(ls);return(0,yt.jsx)(Ft.A,{state:n,role:"treeitem",className:"mailpoet-automation-editor-add-step-button",focusable:!0,onClick:e=>{e.stopPropagation();const n=e.target.closest("button");t(n)},children:(0,yt.jsx)(Dt.Z,{icon:Et.Z,size:16})})}function ds(){const{setInserterPopoverAnchor:e}=(0,I.dispatch)(vt);return(0,yt.jsx)("div",{className:"mailpoet-automation-editor-separator",children:(0,yt.jsx)(us,{onClick:t=>e(t)})})}var ps=n(78869);function ms(){return(0,yt.jsxs)("svg",{viewBox:"0 0 24 18",xmlns:"http://www.w3.org/2000/svg",children:[(0,yt.jsx)("path",{d:"M16.1135 1.06667L22.6469 7.6C23.4635 8.3 23.4635 9.7 22.5302 10.5167L15.9969 17.05C15.6469 17.4 15.0635 17.6333 14.5968 17.6333C14.1302 17.6333 13.5468 17.4 13.1968 17.05L6.66352 10.5167C5.84685 9.7 5.84685 8.41667 6.66352 7.6L13.1968 1.06667C14.0135 0.25 15.2968 0.25 16.1135 1.06667Z"}),(0,yt.jsx)("path",{d:"M9.46352 1.41667L2.11352 8.76667C1.99685 8.88333 1.99685 9.11667 2.23018 9.11667L9.58018 16.4667L8.29685 17.75L0.946851 10.5167C0.130184 9.7 0.130184 8.41667 0.946851 7.6L8.29685 0.25L9.46352 1.41667Z"})]})}function fs(e){let{foreground:t,background:n,...r}=e;return(0,yt.jsx)("div",{className:"mailpoet-automation-colored-icon",style:{width:r.width,height:r.height,backgroundColor:n,fill:t},children:(0,yt.jsx)(_.Z,{...r})})}function gs(e){if("trigger"===e.type)return(0,yt.jsx)(fs,{foreground:"#2271b1",background:"#f0f6fc",width:"23px",height:"23px",icon:ms});const t=(0,I.select)(vt).getStepType(e.key);return t?(0,yt.jsx)(fs,{width:"23px",height:"23px",foreground:t.foreground,background:t.background,icon:t.icon}):null}function hs(e){if("trigger"===e.type)return"Trigger";const t=(0,I.select)(vt).getStepType(e.key);return t?t.title:""}function vs(e){if("mailpoet:segment:subscribed"===e.key)return"Subscribed to segment";const t=(0,I.select)(vt).getStepType(e.key);return t?t.subtitle(e):null}function _s(e){let{step:t,isSelected:n}=e;const{openSidebar:r,selectStep:i}=(0,T.Z)(vt),o=(0,k.useContext)(ls),{batch:s}=(0,ps.Z)();return(0,yt.jsxs)(Ft.A,{state:o,role:"treeitem",className:"mailpoet-automation-editor-step "+(n?"selected-step":""),focusable:!0,onClick:()=>s((()=>{r(Ge),i(t)})),children:[(0,yt.jsx)("div",{className:"mailpoet-automation-editor-step-icon",children:gs(t)}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("div",{className:"mailpoet-automation-editor-step-title",children:hs(t)}),(0,yt.jsx)("div",{className:"mailpoet-automation-editor-step-subtitle",children:vs(t)})]})]},t.id)}function bs(){const{inserterPopoverAnchor:e}=(0,y.Z)((e=>({inserterPopoverAnchor:e(vt).getInserterPopoverAnchor()})),[]),{setInserterPopoverAnchor:t}=(0,I.dispatch)(vt);return e?(0,yt.jsx)(b.Z,{anchorRect:e.getBoundingClientRect(),onClose:()=>t(void 0),children:(0,yt.jsx)(Xt,{})}):null}function ys(){const{workflowData:e,selectedStep:t}=(0,y.Z)((e=>({workflowData:e(vt).getWorkflowData(),selectedStep:e(vt).getSelectedStep()})),[]),n=(0,qt.u)({orientation:"vertical",wrap:"horizontal",shift:!0}),r=(null==e?void 0:e.steps)??void 0,i=(0,k.useMemo)((()=>Object.values(r??{}).filter((e=>{let{type:t}=e;return"trigger"===t}))),[r]),o=(0,k.useMemo)((()=>{if(!r||i.length<1)return[];const e=[i[0]];for(;;){const t=e[e.length-1];if(!("next_step_id"in t)||!t.next_step_id||!r[t.next_step_id])break;e.push(r[t.next_step_id])}return e}),[i,r]);return e?(0,yt.jsxs)(ls.Provider,{value:n,children:[(0,yt.jsx)(as,{}),(0,yt.jsxs)(bn.b,{state:n,role:"tree","aria-orientation":"vertical",className:"mailpoet-automation-editor-workflow",children:[(0,yt.jsxs)("div",{className:"mailpoet-automation-editor-workflow-wrapper",children:[(0,yt.jsx)("div",{}),o.map(((e,n)=>(0,yt.jsxs)(k.Fragment,{children:[n>0&&(0,yt.jsx)(ds,{}),(0,yt.jsx)(_s,{step:e,isSelected:t&&e.id===t.id})]},e.id))),(0,yt.jsx)("div",{})]}),(0,yt.jsx)(bs,{})]})]}):(0,yt.jsx)(cs,{})}var ks=n(93702),Ss=n(9090),ws=n(6258),Es=n(97873);function xs(e){let{title:t,children:n}=e;return(0,yt.jsxs)("h2",{className:"components-panel__body-title mailpoet-automation-panel-plain-body-title",children:[(0,yt.jsx)("div",{className:"mailpoet-automation-panel-plain-body-title-text",children:t}),n]})}function Ts(e){return(0,yt.jsx)("div",{className:"mailpoet-automation-panel-plain-body-title-action",children:(0,yt.jsx)(v.Z,{...e})})}const Ps=[{label:"Hours",subtitle:e=>`Wait for ${e} ${1===e?"hour":"hours"}`,value:"HOURS"},{label:"Days",subtitle:e=>`Wait for ${e} ${1===e?"day":"days"}`,value:"DAYS"},{label:"Weeks",subtitle:e=>`Wait for ${e} ${1===e?"week":"weeks"}`,value:"WEEKS"}],js={key:"core:delay",group:"actions",title:"Delay",foreground:"#7F54B3",background:"#f7edf7",description:"Wait some time before proceeding with the steps below",subtitle:e=>{return e.args.delay&&e.args.delay_type?(t=e.args.delay_type,n=e.args.delay,Ps.reduce(((e,r)=>r.value!==t?e:r.subtitle(n)),"")):"Not set up yet.";var t,n},icon:function(){return(0,yt.jsx)("svg",{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,yt.jsx)("path",{d:"M9.79683 0.666656C4.6635 0.666656 0.463501 4.86666 0.463501 9.99999C0.463501 15.1333 4.6635 19.3333 9.79683 19.3333C14.9302 19.3333 19.1302 15.1333 19.1302 9.99999C19.1302 4.86666 14.9302 0.666656 9.79683 0.666656ZM9.79683 17.4667C5.68083 17.4667 2.33017 14.116 2.33017 9.99999C2.33017 5.88399 5.68083 2.53332 9.79683 2.53332C13.9128 2.53332 17.2635 5.88399 17.2635 9.99999C17.2635 14.116 13.9128 17.4667 9.79683 17.4667ZM10.2635 5.33332H8.8635V10.9333L13.7168 13.92L14.4635 12.7067L10.2635 10.1867V5.33332Z"})})},edit:function(){const{selectedStep:e}=(0,y.Z)((e=>({selectedStep:e(vt).getSelectedStep()})),[]);return(0,yt.jsxs)(sn.Z,{opened:!0,children:[(0,yt.jsx)(xs,{title:"Wait for"}),(0,yt.jsxs)(Ss.Z,{align:"top",children:[(0,yt.jsx)(ws.Z,{style:{flex:"1 1 0"},children:(0,yt.jsx)(Oe.Z,{label:"",type:"number",placeholder:"Number",value:e.args.delay??"",onChange:t=>{const n=0===t.length||parseInt(t,10)<1?1:parseInt(t,10);(0,I.dispatch)(vt).updateStepArgs(e.id,"delay",n)}})}),(0,yt.jsx)(ws.Z,{style:{flex:"1 1 0"},children:(0,yt.jsx)(Es.Z,{label:"",value:e.args.delay_type??"HOURS",options:Ps,onChange:t=>(0,I.dispatch)(vt).updateStepArgs(e.id,"delay_type",t)})})]})]})}};var Cs=n(52405);function Ns(e){let{centered:t,variant:n,...r}=e;return(0,yt.jsx)(v.Z,{className:f()(["sidebar-primary"===n?"mailpoet-automation-button-sidebar-primary":"",t?"mailpoet-automation-button-centered":""]),variant:"sidebar-primary"===n?"primary":n,...r})}function As(){var e;const[t,n]=(0,k.useState)(!1),{selectedStep:r,workflowId:i,workflowSaved:o}=(0,y.Z)((e=>({selectedStep:e(vt).getSelectedStep(),workflowId:e(vt).getWorkflowData().id,workflowSaved:e(vt).getSelectedStep()})),[]),s=null==r||null===(e=r.args)||void 0===e?void 0:e.email_id,a=r.id,l=(0,k.useCallback)((async()=>{n(!0);const e=await mn.x.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"create",data:{type:"automation",subject:"",options:{workflowId:i,workflowStepId:a}}});(0,I.dispatch)(vt).updateStepArgs(a,"email_id",parseInt(e.data.id,10)),(0,I.dispatch)(vt).save()}),[i,a]);return(0,k.useEffect)((()=>{s&&o&&(window.location.href=`admin.php?page=mailpoet-newsletter-editor&id=${s}`)}),[s,o]),(0,yt.jsx)(Ns,{variant:"sidebar-primary",centered:!0,icon:Et.Z,onClick:l,isBusy:t,disabled:t,children:"Design email"})}var Is=n(3386),Zs=n(11699);const Bs=Is.ZP;function Ls(e){let{emailId:t}=e;const[n,r]=(0,k.useState)();return(0,k.useEffect)((()=>{(async()=>{var e;const n=await Zs.G.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"get",data:{id:t}});null!=n&&null!==(e=n.data)&&void 0!==e&&e.thumbnail_url&&r(n.data.thumbnail_url)})()}),[t]),(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("div",{className:"mailpoet-automation-thumbnail-box",children:n?(0,yt.jsx)("div",{className:"mailpoet-automation-thumbnail-wrapper",children:(0,yt.jsx)("img",{className:"mailpoet-automation-thumbnail-image",src:n,alt:"Email thumbnail"})}):(0,yt.jsx)(Bs,{className:"mailpoet-automation-thumbnail-spinner"})}),(0,yt.jsxs)("div",{className:"mailpoet-automation-thumbnail-buttons",children:[(0,yt.jsx)(Ns,{variant:"sidebar-primary",centered:!0,href:`?page=mailpoet-newsletter-editor&id=${t}`,children:"Edit content"}),(0,yt.jsx)(Ns,{variant:"secondary",centered:!0,children:"Preview"})]})]})}var Ds=n(9578);function Ms(e){let{currentName:t,defaultName:n,update:r}=e;return(0,yt.jsx)(Fe.Z,{className:"mailpoet-step-name-dropdown",contentClassName:"mailpoet-step-name-popover",position:"bottom left",renderToggle:e=>{let{isOpen:r,onToggle:i}=e;return(0,yt.jsx)(xs,{title:t.length>0?t:n,children:(0,yt.jsx)(Ts,{onClick:i,"aria-expanded":r,"aria-label":"Edit step name",children:(0,yt.jsx)(Dt.Z,{icon:Ds.Z,size:16})})})},renderContent:()=>(0,yt.jsx)(Oe.Z,{label:"Step name",className:"mailpoet-step-name-input",placeholder:n,value:t,onChange:r,help:"Give the automation step a name that indicates its purpose. E.g “Abandoned cart recovery”. This name will be displayed only to you and not to the clients."})})}function Rs(e){return(0,yt.jsx)(Cs.Z,{...e,onChange:t=>e.onChange(t.replaceAll(/(\r?\n)+/g," ")),onKeyDown:t=>{"Enter"===t.key&&t.preventDefault(),e.onKeyDown&&e.onKeyDown(t)}})}function Os(){const{selectedStep:e,selectedStepType:t}=(0,y.Z)((e=>({selectedStep:e(vt).getSelectedStep(),selectedStepType:e(vt).getSelectedStepType()})),[]);return(0,yt.jsxs)(sn.Z,{opened:!0,children:[(0,yt.jsx)(Ms,{currentName:e.args.name??"",defaultName:t.title,update:t=>{(0,I.dispatch)(vt).updateStepArgs(e.id,"name",t)}}),(0,yt.jsx)(Oe.Z,{label:"“From” name",placeholder:"John Doe",value:e.args.sender_name??"",onChange:t=>(0,I.dispatch)(vt).updateStepArgs(e.id,"sender_name",t)}),(0,yt.jsx)(Oe.Z,{type:"email",label:"“From” email address",placeholder:"you@domain.com",value:e.args.sender_address??"",onChange:t=>(0,I.dispatch)(vt).updateStepArgs(e.id,"sender_address",t)}),(0,yt.jsx)(Rs,{label:"Subject",placeholder:"Type in subject…",value:e.args.subject??"",onChange:t=>(0,I.dispatch)(vt).updateStepArgs(e.id,"subject",t)}),(0,yt.jsx)(Rs,{label:"Preheader",placeholder:"Type in preheader…",value:e.args.preheader??"",onChange:t=>(0,I.dispatch)(vt).updateStepArgs(e.id,"preheader",t)}),(0,yt.jsx)("div",{className:"mailpoet-automation-email-content-separator"}),(0,yt.jsx)(xs,{title:"Email content"}),e.args.email_id?(0,yt.jsx)(Ls,{emailId:e.args.email_id}):(0,yt.jsx)(As,{})]})}var Fs=n(58897),Us=n(77333);const{currentWpUserEmail:Vs,MailPoetComUrlFactory:{getPurchasePlanUrl:Ws,getUpgradeUrl:Hs},subscribersLimitReached:$s,subscribersCount:Gs,premiumActive:zs,hasValidApiKey:Ks,hasValidPremiumKey:Ys,isPremiumPluginInstalled:qs,pluginPartialKey:Js,premiumPluginActivationUrl:Qs}=mn.x;let Xs=qs;const ea=async e=>mn.x.Ajax.post({api_version:mn.x.apiVersion,endpoint:"premium",action:e}),ta=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1?arguments[1]:void 0;const n=e?{utm_source:"plugin",...e}:void 0;return Ys||Ks?!Ys&&Ks?{title:(0,P.__)("Upgrade your MailPoet plan","mailpoet"),info:(0,P.__)("Please upgrade your MailPoet plan.","mailpoet"),cta:(0,P.__)("Upgrade","mailpoet"),action:Hs(Js)}:$s?{title:(0,P.__)("Subscribers limit reached","mailpoet"),info:(0,P.__)("Please upgrade your MailPoet plan to continue using MailPoet.","mailpoet"),cta:(0,P.__)("Upgrade","mailpoet"),action:Hs(Js)}:Ys&&!Xs?{title:(0,P.__)("Download the MailPoet Premium plugin","mailpoet"),info:(0,P.__)("Please download the MailPoet Premium plugin.","mailpoet"),cta:(0,P.__)("Download","mailpoet"),action:{handler:async()=>{await ea("installPlugin"),Xs=!0,t()},busy:(0,P.__)("Downloading…","mailpoet"),success:(0,P.__)("Activate","mailpoet"),successHandler:()=>window.open(Qs,"_blank").focus(),error:(0,P.__)("Plugin installation failed.","mailpoet")}}:Ys&&!zs?{title:(0,P.__)("Activate the MailPoet Premium plugin","mailpoet"),info:(0,P.__)("Please activate the MailPoet Premium plugin.","mailpoet"),cta:(0,P.__)("Activate","mailpoet"),action:{handler:async()=>ea("activatePlugin"),busy:(0,P.__)("Activating…","mailpoet"),success:(0,P.__)("Reload the page","mailpoet"),successHandler:()=>window.location.reload(),error:(0,P.__)("Plugin activation failed.","mailpoet")}}:{title:(0,P.__)("MailPoet Premium is active","mailpoet"),info:(0,P.__)("The MailPoet Premium plugin was activated. Please reload the page.","mailpoet"),cta:(0,P.__)("Reload the page","mailpoet"),action:window.location.href}:{title:(0,P.__)("Purchase a MailPoet plan","mailpoet"),info:(0,P.__)("Please purchase a MailPoet plan.","mailpoet"),cta:(0,P.__)("Purchase","mailpoet"),action:Ws(Gs,Vs,"business",n)}},na=Ys&&!$s&&mn.x.premiumActive,ra=(e,t)=>{const{action:n,cta:r}=t;return"string"==typeof n?r:"busy"===e?n.busy:"success"===e?n.success:r};function ia(e){let{children:t,...n}=e;const[r,i]=(0,k.useState)(),o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;const[t,n]=(0,k.useState)((()=>{const t=()=>n(ta(e,t));return ta(e,t)}));return t}();(0,k.useEffect)((()=>{i(void 0)}),[o]);const s=(0,k.useCallback)((async()=>{if("string"!=typeof o.action)if("success"!==r){i("busy");try{await o.action.handler(),i("success")}catch(e){i("error")}}else o.action.successHandler()}),[r,o.action]);return(0,yt.jsxs)(Us.Z,{className:"mailpoet-premium-modal",title:o.title,closeButtonLabel:(0,P.__)("Cancel","mailpoet"),...n,children:[(0,yt.jsxs)("div",{children:[!na&&t," ",o.info]}),(0,yt.jsxs)("div",{className:"mailpoet-premium-modal-footer",children:[(0,yt.jsx)(v.Z,{variant:"tertiary",onClick:n.onRequestClose,children:(0,P.__)("Cancel","mailpoet")}),"string"==typeof o.action?(0,yt.jsx)(v.Z,{variant:"primary",href:o.action,target:"_blank",rel:"noopener noreferrer",children:o.cta}):(0,yt.jsx)(v.Z,{variant:"primary",isBusy:"busy"===r,disabled:"busy"===r,onClick:s,children:ra(r,o)})]}),"string"!=typeof o.action&&"error"===r&&(0,yt.jsx)("div",{className:"mailpoet-premium-modal-error",children:(0,yt.jsxs)(Ue.Z,{isDestructive:!0,children:[o.action.error," ",(0,P.__)("Please try again.","mailpoet")]})})]})}var oa=n(34517);function sa(){var e;const{selectedStep:t}=(0,y.Z)((e=>({selectedStep:e(vt).getSelectedStep()})),[]),n=void 0!==(null===(e=t.args)||void 0===e?void 0:e.ga_campaign),r=oa.Hooks.applyFilters("mailpoet.automation.send_email.google_analytics_panel",(0,yt.jsx)(ia,{onRequestClose:()=>(0,I.dispatch)(vt).updateStepArgs(t.id,"ga_campaign",void 0),children:(0,P.__)("Google Analytics tracking is not available in the free version of the MailPoet plugin.","mailpoet")}));return(0,yt.jsxs)(sn.Z,{title:"Google analytics",initialOpen:!1,children:[(0,yt.jsx)(Fs.Z,{label:"Enable custom GA tracking",checked:n,onChange:e=>(0,I.dispatch)(vt).updateStepArgs(t.id,"ga_campaign",e?"":void 0)}),n&&r]})}function aa(){const{selectedStep:e}=(0,y.Z)((e=>({selectedStep:e(vt).getSelectedStep()})),[]),t=e.args.reply_to_name,n=e.args.reply_to_address,r=void 0!==t||void 0!==n;return(0,yt.jsxs)(sn.Z,{title:"Reply to",initialOpen:!1,children:[(0,yt.jsx)(Fs.Z,{label:"Use different email address for getting replies to the email",checked:r,onChange:t=>{(0,I.dispatch)(vt).updateStepArgs(e.id,"reply_to_name",t?"":void 0),(0,I.dispatch)(vt).updateStepArgs(e.id,"reply_to_address",t?"":void 0)}}),r&&(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)(Oe.Z,{label:"“Reply to” name",placeholder:"John Doe",value:t??"",onChange:t=>(0,I.dispatch)(vt).updateStepArgs(e.id,"reply_to_name",t)}),(0,yt.jsx)(Oe.Z,{type:"email",label:"“Reply to” email address",placeholder:"you@domain.com",value:n??"",onChange:t=>(0,I.dispatch)(vt).updateStepArgs(e.id,"reply_to_address",t)})]})]})}const la={key:"mailpoet:send-email",group:"actions",title:"Send email",description:"An email will be sent to subscriber",subtitle:e=>e.args.name??"Send email",foreground:"#996800",background:"#FCF9E8",icon:function(){return(0,yt.jsx)("svg",{viewBox:"0 0 16 12",xmlns:"http://www.w3.org/2000/svg",children:(0,yt.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.73578 1.5L8 6.01219L13.2642 1.5H2.73578ZM14.5 2.41638L8.48809 7.56944L8 7.98781L7.51191 7.56944L1.5 2.41638V10C1.5 10.2761 1.72386 10.5 2 10.5H14C14.2761 10.5 14.5 10.2761 14.5 10V2.41638ZM0 2C0 0.89543 0.89543 0 2 0H14C15.1046 0 16 0.895431 16 2V10C16 11.1046 15.1046 12 14 12H2C0.895431 12 0 11.1046 0 10V2Z"})})},edit:function(){return(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)(Os,{}),(0,yt.jsx)(aa,{}),(0,yt.jsx)(sa,{})]})}};function ca(){const{isFullscreenActive:e,isInserterOpened:t,isSidebarOpened:n,showIconLabels:r,workflow:i}=(0,y.Z)((e=>({isFullscreenActive:e(vt).isFeatureActive("fullscreenMode"),isInserterOpened:e(vt).isInserterSidebarOpened(),isSidebarOpened:e(vt).isSidebarOpened(),showIconLabels:e(vt).isFeatureActive("showIconLabels"),workflow:e(vt).getWorkflowData()})),[]),o=f()("interface-interface-skeleton",{"is-sidebar-opened":n,"show-icon-labels":r});return"trash"===i.status?(window.location.href=(0,Me.f)(mn.x.urls.automationListing,{[fn.E.workflowHadBeenDeleted]:i.id}),null):(0,yt.jsx)(De.vn,{children:(0,yt.jsxs)(h.zt,{children:[(0,yt.jsx)(Ce,{isActive:e}),(0,yt.jsx)(tn,{}),(0,yt.jsx)(_n,{}),(0,yt.jsx)(Ie,{className:o,drawer:e&&(0,yt.jsx)("div",{className:"edit-site-navigation-toggle",children:(0,yt.jsx)(v.Z,{className:"edit-site-navigation-toggle__button has-icon",href:"admin.php?page=mailpoet-automation",children:(0,yt.jsx)(_.Z,{size:36,icon:w})})}),header:(0,yt.jsx)(Bt,{}),content:(0,yt.jsx)(ys,{}),sidebar:(0,yt.jsx)(je.Slot,{scope:He}),secondarySidebar:t?(0,yt.jsx)(en,{}):null}),(0,yt.jsx)(b.Z.Slot,{})]})})}window.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("mailpoet_automation_editor");e&&((0,ks.qN)(),_t(js),_t(la),g.render((0,yt.jsx)(ca,{}),e))}))},65311:function(e){e.exports=jQuery}},function(e){e.O(0,[351],(function(){return 29488,e(e.s=29488)})),e.O()}]);